From cb12426724ec401f31fb65318fea76c07fc3c9be Mon Sep 17 00:00:00 2001
From: Ivan Iskandar <iiiiskandar14@gmail.com>
Date: Sun, 18 Sep 2016 10:12:05 +0700
Subject: [PATCH 01/20] Settings: Expose dashboard category and tile color

Change-Id: Ia9c83eb9b8360923ed52e03641b4179681a80330
---
 res/drawable/dashboard_category_title_bg.xml | 21 +++++++++++++++++++++
 res/drawable/dashboard_tile_bg.xml           | 21 +++++++++++++++++++++
 res/drawable/selectable_card.xml             |  4 ++--
 res/layout/dashboard_category.xml            |  2 +-
 res/values/projekt_colors.xml                | 21 +++++++++++++++++++++
 5 files changed, 66 insertions(+), 3 deletions(-)
 create mode 100644 res/drawable/dashboard_category_title_bg.xml
 create mode 100644 res/drawable/dashboard_tile_bg.xml
 create mode 100644 res/values/projekt_colors.xml

diff --git a/res/drawable/dashboard_category_title_bg.xml b/res/drawable/dashboard_category_title_bg.xml
new file mode 100644
index 0000000000..7427ee9b05
--- /dev/null
+++ b/res/drawable/dashboard_category_title_bg.xml
@@ -0,0 +1,21 @@
+<?xml version="1.0" encoding="utf-8"?>
+<!--
+    Copyright (c) 2016-2017 Projekt Substratum
+
+    Licensed under the Apache License, Version 2.0 (the "License");
+    you may not use this file except in compliance with the License.
+    You may obtain a copy of the License at
+
+        http://www.apache.org/licenses/LICENSE-2.0
+
+    Unless required by applicable law or agreed to in writing, software
+    distributed under the License is distributed on an "AS IS" BASIS,
+    WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+    See the License for the specific language governing permissions and
+    limitations under the License.
+-->
+
+<shape xmlns:android="http://schemas.android.com/apk/res/android"
+       android:shape="rectangle">
+   <solid android:color="@color/dashboard_category_title_background" />
+</shape>
diff --git a/res/drawable/dashboard_tile_bg.xml b/res/drawable/dashboard_tile_bg.xml
new file mode 100644
index 0000000000..e8a190b677
--- /dev/null
+++ b/res/drawable/dashboard_tile_bg.xml
@@ -0,0 +1,21 @@
+<?xml version="1.0" encoding="utf-8"?>
+<!--
+    Copyright (c) 2016-2017 Projekt Substratum
+
+    Licensed under the Apache License, Version 2.0 (the "License");
+    you may not use this file except in compliance with the License.
+    You may obtain a copy of the License at
+
+        http://www.apache.org/licenses/LICENSE-2.0
+
+    Unless required by applicable law or agreed to in writing, software
+    distributed under the License is distributed on an "AS IS" BASIS,
+    WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+    See the License for the specific language governing permissions and
+    limitations under the License.
+-->
+
+<shape xmlns:android="http://schemas.android.com/apk/res/android"
+       android:shape="rectangle">
+   <solid android:color="@color/selectable_card_background" />
+</shape>
diff --git a/res/drawable/selectable_card.xml b/res/drawable/selectable_card.xml
index df9ddb1367..74018b214b 100644
--- a/res/drawable/selectable_card.xml
+++ b/res/drawable/selectable_card.xml
@@ -18,5 +18,5 @@
 <ripple
     xmlns:android="http://schemas.android.com/apk/res/android"
     android:color="?android:attr/colorControlHighlight">
-    <item android:drawable="@color/card_background"/>
-</ripple>
\ No newline at end of file
+    <item android:drawable="@drawable/dashboard_tile_bg"/>
+</ripple>
diff --git a/res/layout/dashboard_category.xml b/res/layout/dashboard_category.xml
index 2e5dd5ce06..7836644806 100644
--- a/res/layout/dashboard_category.xml
+++ b/res/layout/dashboard_category.xml
@@ -20,7 +20,7 @@
     android:layout_height="@dimen/dashboard_category_height"
     android:orientation="vertical"
     android:paddingBottom="8dip"
-    android:background="@color/card_background">
+    android:background="@drawable/dashboard_category_title_bg">
 
     <TextView android:id="@android:id/title"
         android:layout_width="match_parent"
diff --git a/res/values/projekt_colors.xml b/res/values/projekt_colors.xml
new file mode 100644
index 0000000000..c30d7eda21
--- /dev/null
+++ b/res/values/projekt_colors.xml
@@ -0,0 +1,21 @@
+<?xml version="1.0" encoding="utf-8"?>
+<!--
+    Copyright (c) 2016-2017 Projekt Substratum
+
+    Licensed under the Apache License, Version 2.0 (the "License");
+    you may not use this file except in compliance with the License.
+    You may obtain a copy of the License at
+
+        http://www.apache.org/licenses/LICENSE-2.0
+
+    Unless required by applicable law or agreed to in writing, software
+    distributed under the License is distributed on an "AS IS" BASIS,
+    WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+    See the License for the specific language governing permissions and
+    limitations under the License.
+-->
+<resources>
+    <!-- Dashboard category and tile background -->
+    <color name="dashboard_category_title_background">@color/card_background</color>
+    <color name="selectable_card_background">@color/card_background</color>
+</resources>

From 5ed39ac8bd5407b259854dcc96f2314157e123ef Mon Sep 17 00:00:00 2001
From: daveyannihilation <daveyannihilation@hotmail.com>
Date: Tue, 20 Sep 2016 23:35:04 +0800
Subject: [PATCH 02/20] Settings: Expose condition card colors

PS2 Change to the actual colors in fwb that these attrs call to.

@nathanchance edit: updated for Nougat 7.1

Change-Id: I8de2e2a4f79a28c0fe1f025b4d23937931fe293a
---
 res/layout/condition_card.xml | 16 ++++++++--------
 res/values/projekt_colors.xml |  9 +++++++++
 2 files changed, 17 insertions(+), 8 deletions(-)

diff --git a/res/layout/condition_card.xml b/res/layout/condition_card.xml
index 7c9e46da00..a5eb6c85cf 100644
--- a/res/layout/condition_card.xml
+++ b/res/layout/condition_card.xml
@@ -25,7 +25,7 @@
         android:layout_width="match_parent"
         android:layout_height="wrap_content"
         android:orientation="vertical"
-        android:background="?android:attr/colorAccent"
+        android:background="@color/condition_card_background_color"
         android:elevation="2dp"
         android:clickable="true"
         android:focusable="true">
@@ -44,7 +44,7 @@
                 android:layout_height="wrap_content"
                 android:layout_marginStart="16dp"
                 android:layout_marginEnd="32dp"
-                android:tint="?android:attr/textColorPrimaryInverse" />
+                android:tint="@color/condition_card_icon_color" />
 
             <TextView
                 android:id="@android:id/title"
@@ -52,14 +52,14 @@
                 android:layout_height="wrap_content"
                 android:layout_weight="1"
                 android:textAppearance="?android:attr/textAppearanceMedium"
-                android:textColor="?android:attr/textColorPrimaryInverse" />
+                android:textColor="@color/condition_card_title_text_color" />
 
             <ImageView
                 android:id="@+id/expand_indicator"
                 android:layout_width="wrap_content"
                 android:layout_height="match_parent"
                 android:padding="16dp"
-                android:tint="?android:attr/textColorPrimaryInverse"/>
+                android:tint="@color/condition_card_expander_color" />
 
         </LinearLayout>
 
@@ -81,14 +81,14 @@
                 android:paddingBottom="16dp"
                 android:textAppearance="?android:attr/textAppearanceListItemSecondary"
                 android:alpha=".7"
-                android:textColor="?android:attr/textColorPrimaryInverse" />
+                android:textColor="@color/condition_card_summary_text_color" />
 
             <!-- TODO: Better background -->
             <View
                 android:id="@+id/divider"
                 android:layout_width="match_parent"
                 android:layout_height=".25dp"
-                android:background="@android:color/white" />
+                android:background="@color/condition_card_divider_color" />
 
             <com.android.internal.widget.ButtonBarLayout
                 android:id="@+id/buttonBar"
@@ -107,7 +107,7 @@
                     android:paddingStart="0dp"
                     android:alpha=".8"
                     android:textAlignment="viewStart"
-                    android:textColor="?android:attr/textColorPrimaryInverse"
+                    android:textColor="@color/condition_card_first_button_text_color"
                     style="?android:attr/buttonBarButtonStyle" />
 
                 <Button
@@ -117,7 +117,7 @@
                     android:layout_weight="1"
                     android:alpha=".8"
                     android:textAlignment="viewStart"
-                    android:textColor="?android:attr/textColorPrimaryInverse"
+                    android:textColor="@color/condition_card_second_button_text_color"
                     style="?android:attr/buttonBarButtonStyle" />
 
             </com.android.internal.widget.ButtonBarLayout>
diff --git a/res/values/projekt_colors.xml b/res/values/projekt_colors.xml
index c30d7eda21..ea54a02a24 100644
--- a/res/values/projekt_colors.xml
+++ b/res/values/projekt_colors.xml
@@ -18,4 +18,13 @@
     <!-- Dashboard category and tile background -->
     <color name="dashboard_category_title_background">@color/card_background</color>
     <color name="selectable_card_background">@color/card_background</color>
+    <!-- Condition card colors -->
+    <color name="condition_card_background_color">@*android:color/accent_device_default_light</color>
+    <color name="condition_card_icon_color">@*android:color/primary_text_default_material_dark</color>
+    <color name="condition_card_title_text_color">@*android:color/primary_text_default_material_dark</color>
+    <color name="condition_card_expander_color">@*android:color/primary_text_default_material_dark</color>
+    <color name="condition_card_summary_text_color">@*android:color/primary_text_default_material_dark</color>
+    <color name="condition_card_divider_color">@android:color/white</color>
+    <color name="condition_card_first_button_text_color">@*android:color/primary_text_default_material_dark</color>
+    <color name="condition_card_second_button_text_color">@*android:color/primary_text_default_material_dark</color>
 </resources>

From 80c317d2ba757438f77f709f3026fb983e292042 Mon Sep 17 00:00:00 2001
From: George G <kreach3r@users.noreply.github.com>
Date: Tue, 3 Nov 2015 23:57:22 +0200
Subject: [PATCH 03/20] Settings: Expose storage summary text

This commit simply exposes the storage summary text hardcodes to allow
themers to theme them without issue.

@nathanchance edit: updated for Nougat 7.1

Change-Id: I10c124b6a1516a1be7ac234c1dd7dbe2cbe05bb2
---
 res/layout/storage_summary.xml                                    | 2 +-
 res/values/projekt_colors.xml                                     | 2 ++
 src/com/android/settings/deviceinfo/StorageSummaryPreference.java | 8 +++++++-
 src/com/android/settings/deviceinfo/StorageVolumePreference.java  | 8 +++++++-
 4 files changed, 17 insertions(+), 3 deletions(-)

diff --git a/res/layout/storage_summary.xml b/res/layout/storage_summary.xml
index 7bc51df5e6..c01d2dae5d 100644
--- a/res/layout/storage_summary.xml
+++ b/res/layout/storage_summary.xml
@@ -33,7 +33,7 @@
         android:singleLine="true"
         android:textAlignment="viewStart"
         android:textAppearance="@android:style/TextAppearance.Material.Subhead"
-        android:textColor="?android:attr/colorAccent"
+        android:textColor="@color/storage_summary_title_color"
         android:textSize="36sp"
         android:ellipsize="marquee"
         android:fadingEdge="horizontal" />
diff --git a/res/values/projekt_colors.xml b/res/values/projekt_colors.xml
index ea54a02a24..9cb442b1b5 100644
--- a/res/values/projekt_colors.xml
+++ b/res/values/projekt_colors.xml
@@ -27,4 +27,6 @@
     <color name="condition_card_divider_color">@android:color/white</color>
     <color name="condition_card_first_button_text_color">@*android:color/primary_text_default_material_dark</color>
     <color name="condition_card_second_button_text_color">@*android:color/primary_text_default_material_dark</color>
+    <!-- Storage Summary Title -->
+    <color name="storage_summary_title_color">@*android:color/accent_device_default_light</color>
 </resources>
diff --git a/src/com/android/settings/deviceinfo/StorageSummaryPreference.java b/src/com/android/settings/deviceinfo/StorageSummaryPreference.java
index e1cf7742ef..274179830c 100644
--- a/src/com/android/settings/deviceinfo/StorageSummaryPreference.java
+++ b/src/com/android/settings/deviceinfo/StorageSummaryPreference.java
@@ -21,6 +21,7 @@
 import android.support.v7.preference.Preference;
 import android.support.v7.preference.PreferenceViewHolder;
 import android.view.View;
+import android.util.TypedValue;
 import android.widget.ProgressBar;
 import android.widget.TextView;
 
@@ -28,12 +29,17 @@
 
 public class StorageSummaryPreference extends Preference {
     private int mPercent = -1;
+    private int mSecondaryColor;
 
     public StorageSummaryPreference(Context context) {
         super(context);
 
         setLayoutResource(R.layout.storage_summary);
         setEnabled(false);
+
+        TypedValue typedValue = new TypedValue();
+        context.getTheme().resolveAttribute(android.R.attr.textColorSecondary, typedValue, true);
+        mSecondaryColor = context.getResources().getColor(typedValue.resourceId);
     }
 
     public void setPercent(int percent) {
@@ -52,7 +58,7 @@ public void onBindViewHolder(PreferenceViewHolder view) {
         }
 
         final TextView summary = (TextView) view.findViewById(android.R.id.summary);
-        summary.setTextColor(Color.parseColor("#8a000000"));
+        summary.setTextColor(mSecondaryColor);
 
         super.onBindViewHolder(view);
     }
diff --git a/src/com/android/settings/deviceinfo/StorageVolumePreference.java b/src/com/android/settings/deviceinfo/StorageVolumePreference.java
index 63890758ba..9d3c7dccf2 100644
--- a/src/com/android/settings/deviceinfo/StorageVolumePreference.java
+++ b/src/com/android/settings/deviceinfo/StorageVolumePreference.java
@@ -27,6 +27,7 @@
 import android.text.format.Formatter;
 import android.view.View;
 import android.view.View.OnClickListener;
+import android.util.TypedValue;
 import android.widget.ImageView;
 import android.widget.ProgressBar;
 
@@ -44,6 +45,7 @@
     private final VolumeInfo mVolume;
 
     private int mColor;
+    private int mSecondaryColor;
     private int mUsedPercent = -1;
 
     // TODO: ideally, VolumeInfo should have a total physical size.
@@ -54,6 +56,10 @@ public StorageVolumePreference(Context context, VolumeInfo volume, int color, lo
         mVolume = volume;
         mColor = color;
 
+        TypedValue typedValue = new TypedValue();
+        context.getTheme().resolveAttribute(android.R.attr.textColorSecondary, typedValue, true);
+        mSecondaryColor = context.getResources().getColor(typedValue.resourceId);
+
         setLayoutResource(R.layout.storage_volume);
 
         setKey(volume.getId());
@@ -107,7 +113,7 @@ public StorageVolumePreference(Context context, VolumeInfo volume, int color, lo
     public void onBindViewHolder(PreferenceViewHolder view) {
         final ImageView unmount = (ImageView) view.findViewById(R.id.unmount);
         if (unmount != null) {
-            unmount.setImageTintList(ColorStateList.valueOf(Color.parseColor("#8a000000")));
+            unmount.setImageTintList(ColorStateList.valueOf(mSecondaryColor));
             unmount.setOnClickListener(mUnmountListener);
         }
 

From a2e68dda2d723ad84e33fda3b89b6e7178934231 Mon Sep 17 00:00:00 2001
From: daveyannihilation <daveyannihilation@hotmail.com>
Date: Fri, 25 Nov 2016 15:20:04 -0700
Subject: [PATCH 04/20] Settings: Expose gesture settings switchbar

In Settings > Gestures, there is a hardcoded white background above each switch. Link to a colors.xml value instead.

Commit written by @nathanchance, idea by @daveyannihilation

Signed-off-by: Nathan Chancellor <natechancellor@gmail.com>
Change-Id: I9857c10ee4e54d27ca1287c80a7d8e420adc9a61
---
 res/layout/gesture_preference.xml | 2 +-
 res/values/projekt_colors.xml     | 3 +++
 2 files changed, 4 insertions(+), 1 deletion(-)

diff --git a/res/layout/gesture_preference.xml b/res/layout/gesture_preference.xml
index ccbc42ad25..9fcd14f3fc 100644
--- a/res/layout/gesture_preference.xml
+++ b/res/layout/gesture_preference.xml
@@ -31,7 +31,7 @@
         android:paddingBottom="16dp"
         android:paddingStart="?android:attr/listPreferredItemPaddingStart"
         android:paddingEnd="?android:attr/listPreferredItemPaddingEnd"
-        android:background="@android:color/white">
+        android:background="@color/gestures_switchbar_color">
 
         <TextView
             android:id="@android:id/title"
diff --git a/res/values/projekt_colors.xml b/res/values/projekt_colors.xml
index 9cb442b1b5..afde5ae973 100644
--- a/res/values/projekt_colors.xml
+++ b/res/values/projekt_colors.xml
@@ -29,4 +29,7 @@
     <color name="condition_card_second_button_text_color">@*android:color/primary_text_default_material_dark</color>
     <!-- Storage Summary Title -->
     <color name="storage_summary_title_color">@*android:color/accent_device_default_light</color>
+    <!-- Gesture settings switchbar background -->
+    <color name="gestures_switchbar_color">@android:color/white</color>
+
 </resources>

From 4de54b656fd14a50a3fb9ca4faf19743e601d69a Mon Sep 17 00:00:00 2001
From: SpiritCroc <spiritcroc@gmail.com>
Date: Thu, 8 Dec 2016 20:40:16 +0100
Subject: [PATCH 05/20] Settings: Expose storage icon colors

Change-Id: I97ce427f0683791670f1bbf82eaef66152fe4961
---
 res/values/projekt_colors.xml                      |  9 +++++-
 .../settings/deviceinfo/StorageSettings.java       | 32 ++++++++++++++--------
 .../deviceinfo/StorageVolumePreference.java        |  2 +-
 3 files changed, 29 insertions(+), 14 deletions(-)

diff --git a/res/values/projekt_colors.xml b/res/values/projekt_colors.xml
index afde5ae973..2bee210dfd 100644
--- a/res/values/projekt_colors.xml
+++ b/res/values/projekt_colors.xml
@@ -31,5 +31,12 @@
     <color name="storage_summary_title_color">@*android:color/accent_device_default_light</color>
     <!-- Gesture settings switchbar background -->
     <color name="gestures_switchbar_color">@android:color/white</color>
-
+    <!-- Storage icons -->
+    <color name="storage_public">#ff9e9e9e</color>
+    <color name="storage_warning">#fff4511e</color>
+    <color name="storage_private_1">#ff26a69a</color>
+    <color name="storage_private_2">#ffab47bc</color>
+    <color name="storage_private_3">#fff2a600</color>
+    <color name="storage_private_4">#ffec407a</color>
+    <color name="storage_private_5">#ffc0ca33</color>
 </resources>
diff --git a/src/com/android/settings/deviceinfo/StorageSettings.java b/src/com/android/settings/deviceinfo/StorageSettings.java
index 4b97fc33fd..a7cc2597b4 100755
--- a/src/com/android/settings/deviceinfo/StorageSettings.java
+++ b/src/com/android/settings/deviceinfo/StorageSettings.java
@@ -24,6 +24,7 @@
 import android.content.Context;
 import android.content.DialogInterface;
 import android.content.Intent;
+import android.content.res.Resources ;
 import android.graphics.Color;
 import android.graphics.drawable.Drawable;
 import android.os.AsyncTask;
@@ -75,16 +76,22 @@
     private static final String TAG_VOLUME_UNMOUNTED = "volume_unmounted";
     private static final String TAG_DISK_INIT = "disk_init";
 
-    static final int COLOR_PUBLIC = Color.parseColor("#ff9e9e9e");
-    static final int COLOR_WARNING = Color.parseColor("#fff4511e");
+    static int getColorPublic(Resources resources) {
+        return resources.getColor(R.color.storage_public);
+    }
+    static int getColorWarning(Resources resources) {
+        return resources.getColor(R.color.storage_warning);
+    }
 
-    static final int[] COLOR_PRIVATE = new int[] {
-            Color.parseColor("#ff26a69a"),
-            Color.parseColor("#ffab47bc"),
-            Color.parseColor("#fff2a600"),
-            Color.parseColor("#ffec407a"),
-            Color.parseColor("#ffc0ca33"),
-    };
+    static int[] getColorPrivate(Resources resources) {
+        return new int[] {
+                resources.getColor(R.color.storage_private_1),
+                resources.getColor(R.color.storage_private_2),
+                resources.getColor(R.color.storage_private_3),
+                resources.getColor(R.color.storage_private_4),
+                resources.getColor(R.color.storage_private_5),
+        };
+    }
 
     private StorageManager mStorageManager;
 
@@ -168,11 +175,12 @@ private void refresh() {
         Collections.sort(volumes, VolumeInfo.getDescriptionComparator());
 
         long primaryPhysicalTotalSpace = PrivateStorageInfo.getPrimaryPhysicalTotalSpace(volumes);
+        int[] colorPrivate = getColorPrivate(getResources());
         for (VolumeInfo vol : volumes) {
             if (vol.getType() == VolumeInfo.TYPE_PRIVATE) {
                 final long volumeTotalBytes = PrivateStorageInfo.getTotalSize(vol,
                         sTotalInternalStorage) - primaryPhysicalTotalSpace;
-                final int color = COLOR_PRIVATE[privateCount++ % COLOR_PRIVATE.length];
+                final int color = colorPrivate[privateCount++ % colorPrivate.length];
                 mInternalCategory.addPreference(
                         new StorageVolumePreference(context, vol, color, volumeTotalBytes));
                 if (vol.isMountedReadable()) {
@@ -182,7 +190,7 @@ private void refresh() {
                 }
             } else if (vol.getType() == VolumeInfo.TYPE_PUBLIC) {
                 StorageVolumePreference ExStorageVolumePreference =
-                        new StorageVolumePreference(context, vol, COLOR_PUBLIC, 0);
+                        new StorageVolumePreference(context, vol, getColorPublic(getResources()), 0);
 
                 //Disable preference when in change
                 ExStorageVolumePreference.setEnabled(vol.getState()!= VolumeInfo.STATE_CHECKING
@@ -199,7 +207,7 @@ private void refresh() {
                 // TODO: add actual storage type to record
                 final Drawable icon = context.getDrawable(R.drawable.ic_sim_sd);
                 icon.mutate();
-                icon.setTint(COLOR_PUBLIC);
+                icon.setTint(getColorPublic(getResources()));
 
                 final Preference pref = new Preference(context);
                 pref.setKey(rec.getFsUuid());
diff --git a/src/com/android/settings/deviceinfo/StorageVolumePreference.java b/src/com/android/settings/deviceinfo/StorageVolumePreference.java
index 9d3c7dccf2..8a2780a90b 100644
--- a/src/com/android/settings/deviceinfo/StorageVolumePreference.java
+++ b/src/com/android/settings/deviceinfo/StorageVolumePreference.java
@@ -89,7 +89,7 @@ public StorageVolumePreference(Context context, VolumeInfo volume, int color, lo
             }
 
             if (freeBytes < mStorageManager.getStorageLowBytes(path)) {
-                mColor = StorageSettings.COLOR_WARNING;
+                mColor = StorageSettings.getColorWarning(context.getResources());
                 icon = context.getDrawable(R.drawable.ic_warning_24dp);
             }
 

From 1079750fe8317c343afc9327377f66cca261dd6b Mon Sep 17 00:00:00 2001
From: SpiritCroc <spiritcroc@gmail.com>
Date: Fri, 9 Dec 2016 12:47:54 +0100
Subject: [PATCH 06/20] Settings: Expose LinearColorBar default colors

Change-Id: I8e63f10f9e4079d1a03eaece18e8343102f4a755
---
 res/values/projekt_colors.xml                             |  5 +++++
 src/com/android/settings/applications/LinearColorBar.java | 10 +++++++---
 2 files changed, 12 insertions(+), 3 deletions(-)

diff --git a/res/values/projekt_colors.xml b/res/values/projekt_colors.xml
index 2bee210dfd..27efb1d1a7 100644
--- a/res/values/projekt_colors.xml
+++ b/res/values/projekt_colors.xml
@@ -39,4 +39,9 @@
     <color name="storage_private_3">#fff2a600</color>
     <color name="storage_private_4">#ffec407a</color>
     <color name="storage_private_5">#ffc0ca33</color>
+
+    <!-- Linear color bar -->
+    <color name="linear_color_bar_left">@*android:color/accent_device_default_light</color>
+    <color name="linear_color_bar_middle">@*android:color/accent_device_default_light</color>
+    <color name="linear_color_bar_right">#ffced7db</color>
 </resources>
diff --git a/src/com/android/settings/applications/LinearColorBar.java b/src/com/android/settings/applications/LinearColorBar.java
index b637671f73..b0b8b82e8c 100644
--- a/src/com/android/settings/applications/LinearColorBar.java
+++ b/src/com/android/settings/applications/LinearColorBar.java
@@ -15,6 +15,7 @@
 import android.view.MotionEvent;
 import android.widget.LinearLayout;
 import com.android.settings.Utils;
+import com.android.settings.R;
 
 public class LinearColorBar extends LinearLayout {
 
@@ -28,7 +29,7 @@
 
     private int mLeftColor;
     private int mMiddleColor;
-    private int mRightColor = RIGHT_COLOR;
+    private int mRightColor;
 
     private boolean mShowIndicator = true;
     private boolean mShowingGreen;
@@ -70,7 +71,10 @@ public LinearColorBar(Context context, AttributeSet attrs) {
                 ? 2 : 1;
         mEdgeGradientPaint.setStrokeWidth(mLineWidth);
         mEdgeGradientPaint.setAntiAlias(true);
-        mLeftColor = mMiddleColor = Utils.getColorAccent(context);
+
+        mLeftColor = context.getResources().getColor(R.color.linear_color_bar_left);
+        mMiddleColor = context.getResources().getColor(R.color.linear_color_bar_middle);
+        mRightColor = context.getResources().getColor(R.color.linear_color_bar_right);
     }
 
     public void setOnRegionTappedListener(OnRegionTappedListener listener) {
@@ -271,4 +275,4 @@ protected void onDraw(Canvas canvas) {
             canvas.drawRect(mRect, mPaint);
         }
     }
-}
\ No newline at end of file
+}

From 7bf8e07f11fae9ffb6a631f6f523cb95cab0da0a Mon Sep 17 00:00:00 2001
From: George G <kreach3r@users.noreply.github.com>
Date: Mon, 4 Jul 2016 12:07:11 +0300
Subject: [PATCH 07/20] OMS7-N: Apps: show/hide Substratum overlays [2/2]

Default behavior is "hidden" substratum overlays,
as they pollute the screen, and you can't notice the
actual apps.
So we follow the current trend set by Android with
"show system" and make it "show overlays" on default.

Change-Id: I1cd4d4d3acd767a87fe402c325a872a4c04e0438
---
 res/menu/manage_apps.xml                           |  8 +++++++
 res/values/projekt_strings.xml                     | 23 ++++++++++++++++++
 .../settings/applications/ManageApplications.java  | 27 +++++++++++++++++++++-
 3 files changed, 57 insertions(+), 1 deletion(-)
 create mode 100644 res/values/projekt_strings.xml

diff --git a/res/menu/manage_apps.xml b/res/menu/manage_apps.xml
index 02ee2bbefd..67f09e5fc8 100644
--- a/res/menu/manage_apps.xml
+++ b/res/menu/manage_apps.xml
@@ -29,6 +29,14 @@
         android:id="@+id/hide_system"
         android:title="@string/menu_hide_system"
         android:showAsAction="never" />
+    <item
+        android:id="@+id/show_substratum"
+        android:title="@string/menu_show_substratum"
+        android:showAsAction="never" />
+    <item
+        android:id="@+id/hide_substratum"
+        android:title="@string/menu_hide_substratum"
+        android:showAsAction="never" />
     <item
         android:id="@+id/sort_order_alpha"
         android:title="@string/sort_order_alpha"
diff --git a/res/values/projekt_strings.xml b/res/values/projekt_strings.xml
new file mode 100644
index 0000000000..ed7cab6c7a
--- /dev/null
+++ b/res/values/projekt_strings.xml
@@ -0,0 +1,23 @@
+<?xml version="1.0" encoding="utf-8"?>
+<!-- Copyright (c) 2016-2017 Projekt Substratum
+
+     Licensed under the Apache License, Version 2.0 (the "License");
+     you may not use this file except in compliance with the License.
+     You may obtain a copy of the License at
+
+          http://www.apache.org/licenses/LICENSE-2.0
+
+     Unless required by applicable law or agreed to in writing, software
+     distributed under the License is distributed on an "AS IS" BASIS,
+     WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+     See the License for the specific language governing permissions and
+     limitations under the License.
+-->
+<resources xmlns:xliff="urn:oasis:names:tc:xliff:document:1.2">
+
+   <!-- Manage applications: show substratum overlays -->
+   <string name="filter_substratum_apps">Substratum overlays</string>
+   <string name="menu_show_substratum">Show overlays</string>
+   <string name="menu_hide_substratum">Hide overlays</string>
+
+</resources>
diff --git a/src/com/android/settings/applications/ManageApplications.java b/src/com/android/settings/applications/ManageApplications.java
index 8b1dd27ef1..070754addb 100644
--- a/src/com/android/settings/applications/ManageApplications.java
+++ b/src/com/android/settings/applications/ManageApplications.java
@@ -107,6 +107,7 @@
 
     private static final String EXTRA_SORT_ORDER = "sortOrder";
     private static final String EXTRA_SHOW_SYSTEM = "showSystem";
+    private static final String EXTRA_SHOW_SUBSTRATUM = "showSubstratum";
     private static final String EXTRA_HAS_ENTRIES = "hasEntries";
     private static final String EXTRA_HAS_BRIDGE = "hasBridge";
 
@@ -138,6 +139,7 @@
     public static final int FILTER_APPS_USAGE_ACCESS = 13;
     public static final int FILTER_APPS_WITH_OVERLAY = 14;
     public static final int FILTER_APPS_WRITE_SETTINGS = 15;
+    public static final int FILTER_APPS_SUBSTRATUM = 16;
 
     // This is the string labels for the filter modes above, the order must be kept in sync.
     public static final int[] FILTER_LABELS = new int[]{
@@ -187,6 +189,9 @@
     // whether showing system apps.
     private boolean mShowSystem;
 
+    // whether showing substratum overlays.
+    private boolean mShowSubstratum;
+
     private ApplicationsState mApplicationsState;
 
     public int mListType;
@@ -276,6 +281,7 @@ public void onCreate(Bundle savedInstanceState) {
         if (savedInstanceState != null) {
             mSortOrder = savedInstanceState.getInt(EXTRA_SORT_ORDER, mSortOrder);
             mShowSystem = savedInstanceState.getBoolean(EXTRA_SHOW_SYSTEM, mShowSystem);
+            mShowSubstratum = savedInstanceState.getBoolean(EXTRA_SHOW_SUBSTRATUM, mShowSubstratum);
         }
 
         mInvalidSizeStr = getActivity().getText(R.string.invalid_size_value);
@@ -440,6 +446,7 @@ public void onSaveInstanceState(Bundle outState) {
         mResetAppsHelper.onSaveInstanceState(outState);
         outState.putInt(EXTRA_SORT_ORDER, mSortOrder);
         outState.putBoolean(EXTRA_SHOW_SYSTEM, mShowSystem);
+        outState.putBoolean(EXTRA_SHOW_SUBSTRATUM, mShowSubstratum);
         outState.putBoolean(EXTRA_HAS_ENTRIES, mApplications.mHasReceivedLoadEntries);
         outState.putBoolean(EXTRA_HAS_BRIDGE, mApplications.mHasReceivedBridgeCallback);
     }
@@ -558,6 +565,11 @@ void updateOptionsMenu() {
                 && mListType != LIST_TYPE_HIGH_POWER);
         mOptionsMenu.findItem(R.id.hide_system).setVisible(mShowSystem
                 && mListType != LIST_TYPE_HIGH_POWER);
+
+        mOptionsMenu.findItem(R.id.show_substratum).setVisible(!mShowSubstratum
+                && mListType != LIST_TYPE_HIGH_POWER);
+        mOptionsMenu.findItem(R.id.hide_substratum).setVisible(mShowSubstratum
+                && mListType != LIST_TYPE_HIGH_POWER);
     }
 
     @Override
@@ -577,6 +589,11 @@ public boolean onOptionsItemSelected(MenuItem item) {
                 mShowSystem = !mShowSystem;
                 mApplications.rebuild(false);
                 break;
+            case R.id.show_substratum:
+            case R.id.hide_substratum:
+                mShowSubstratum = !mShowSubstratum;
+                mApplications.rebuild(false);
+                break;
             case R.id.reset_app_preferences:
                 mResetAppsHelper.buildResetDialog();
                 return true;
@@ -865,9 +882,17 @@ public void rebuild(boolean eraseold) {
             if (mOverrideFilter != null) {
                 filterObj = mOverrideFilter;
             }
-            if (!mManageApplications.mShowSystem) {
+            if (!mManageApplications.mShowSystem && !mManageApplications.mShowSubstratum) {
                 filterObj = new CompoundFilter(filterObj,
                         ApplicationsState.FILTER_DOWNLOADED_AND_LAUNCHER);
+                filterObj = new CompoundFilter(filterObj,
+                        ApplicationsState.FILTER_SUBSTRATUM);
+            } else if (!mManageApplications.mShowSystem) {
+                filterObj = new CompoundFilter(filterObj,
+                        ApplicationsState.FILTER_DOWNLOADED_AND_LAUNCHER);
+            } else if (!mManageApplications.mShowSubstratum) {
+                filterObj = new CompoundFilter(filterObj,
+                        ApplicationsState.FILTER_SUBSTRATUM);
             }
             switch (mLastSortMode) {
                 case R.id.sort_order_size:

From 8f21c9b7e01e5d758baa30a2d6e7b1845fc02682 Mon Sep 17 00:00:00 2001
From: Kuba Schenk <abukcz@gmail.com>
Date: Thu, 1 Dec 2016 22:00:31 +0100
Subject: [PATCH 08/20] OMS7-N: Apps: show/hide Substratum icon overlays [2/2]

Default behavior is "hidden" substratum icon overlays,
as they pollute the screen, and you can't notice the
actual apps.
So we follow the current trend set by Android with
"show system" and make it "show icon overlays" on default.

Change-Id: Ib6dd011f821f21bee6da1979615f2eb4658c9f52
---
 res/menu/manage_apps.xml                           |  8 ++++++
 res/values/projekt_strings.xml                     |  5 ++++
 .../settings/applications/ManageApplications.java  | 33 ++++++++++++++++------
 3 files changed, 37 insertions(+), 9 deletions(-)

diff --git a/res/menu/manage_apps.xml b/res/menu/manage_apps.xml
index 67f09e5fc8..267cff8b41 100644
--- a/res/menu/manage_apps.xml
+++ b/res/menu/manage_apps.xml
@@ -37,6 +37,14 @@
         android:id="@+id/hide_substratum"
         android:title="@string/menu_hide_substratum"
         android:showAsAction="never" />
+    <item
+        android:id="@+id/show_substratum_icons"
+        android:title="@string/menu_show_substratum_icons"
+        android:showAsAction="never" />
+    <item
+        android:id="@+id/hide_substratum_icons"
+        android:title="@string/menu_hide_substratum_icons"
+        android:showAsAction="never" />
     <item
         android:id="@+id/sort_order_alpha"
         android:title="@string/sort_order_alpha"
diff --git a/res/values/projekt_strings.xml b/res/values/projekt_strings.xml
index ed7cab6c7a..004e268b9c 100644
--- a/res/values/projekt_strings.xml
+++ b/res/values/projekt_strings.xml
@@ -20,4 +20,9 @@
    <string name="menu_show_substratum">Show overlays</string>
    <string name="menu_hide_substratum">Hide overlays</string>
 
+   <!-- Manage applications: show substratum icon overlays -->
+   <string name="filter_substratum_icons">Substratum icon overlays</string>
+   <string name="menu_show_substratum_icons">Show icon overlays</string>
+   <string name="menu_hide_substratum_icons">Hide icon overlays</string>
+
 </resources>
diff --git a/src/com/android/settings/applications/ManageApplications.java b/src/com/android/settings/applications/ManageApplications.java
index 070754addb..5d3b353766 100644
--- a/src/com/android/settings/applications/ManageApplications.java
+++ b/src/com/android/settings/applications/ManageApplications.java
@@ -108,6 +108,7 @@
     private static final String EXTRA_SORT_ORDER = "sortOrder";
     private static final String EXTRA_SHOW_SYSTEM = "showSystem";
     private static final String EXTRA_SHOW_SUBSTRATUM = "showSubstratum";
+    private static final String EXTRA_SHOW_SUBSTRATUM_ICONS = "showSubstratumIcons";
     private static final String EXTRA_HAS_ENTRIES = "hasEntries";
     private static final String EXTRA_HAS_BRIDGE = "hasBridge";
 
@@ -139,7 +140,8 @@
     public static final int FILTER_APPS_USAGE_ACCESS = 13;
     public static final int FILTER_APPS_WITH_OVERLAY = 14;
     public static final int FILTER_APPS_WRITE_SETTINGS = 15;
-    public static final int FILTER_APPS_SUBSTRATUM = 16;
+    public static final int FILTER_APPS_SUBSTRATUM_ICONS = 16;
+    public static final int FILTER_APPS_SUBSTRATUM = 17;
 
     // This is the string labels for the filter modes above, the order must be kept in sync.
     public static final int[] FILTER_LABELS = new int[]{
@@ -191,6 +193,7 @@
 
     // whether showing substratum overlays.
     private boolean mShowSubstratum;
+    private boolean mShowSubstratumIcons;
 
     private ApplicationsState mApplicationsState;
 
@@ -282,6 +285,8 @@ public void onCreate(Bundle savedInstanceState) {
             mSortOrder = savedInstanceState.getInt(EXTRA_SORT_ORDER, mSortOrder);
             mShowSystem = savedInstanceState.getBoolean(EXTRA_SHOW_SYSTEM, mShowSystem);
             mShowSubstratum = savedInstanceState.getBoolean(EXTRA_SHOW_SUBSTRATUM, mShowSubstratum);
+            mShowSubstratumIcons = savedInstanceState.getBoolean(EXTRA_SHOW_SUBSTRATUM_ICONS,
+                                                                 mShowSubstratumIcons);
         }
 
         mInvalidSizeStr = getActivity().getText(R.string.invalid_size_value);
@@ -447,6 +452,7 @@ public void onSaveInstanceState(Bundle outState) {
         outState.putInt(EXTRA_SORT_ORDER, mSortOrder);
         outState.putBoolean(EXTRA_SHOW_SYSTEM, mShowSystem);
         outState.putBoolean(EXTRA_SHOW_SUBSTRATUM, mShowSubstratum);
+        outState.putBoolean(EXTRA_SHOW_SUBSTRATUM_ICONS, mShowSubstratumIcons);
         outState.putBoolean(EXTRA_HAS_ENTRIES, mApplications.mHasReceivedLoadEntries);
         outState.putBoolean(EXTRA_HAS_BRIDGE, mApplications.mHasReceivedBridgeCallback);
     }
@@ -570,6 +576,10 @@ void updateOptionsMenu() {
                 && mListType != LIST_TYPE_HIGH_POWER);
         mOptionsMenu.findItem(R.id.hide_substratum).setVisible(mShowSubstratum
                 && mListType != LIST_TYPE_HIGH_POWER);
+        mOptionsMenu.findItem(R.id.show_substratum_icons).setVisible(!mShowSubstratumIcons
+                && mListType != LIST_TYPE_HIGH_POWER);
+        mOptionsMenu.findItem(R.id.hide_substratum_icons).setVisible(mShowSubstratumIcons
+                && mListType != LIST_TYPE_HIGH_POWER);
     }
 
     @Override
@@ -594,6 +604,11 @@ public boolean onOptionsItemSelected(MenuItem item) {
                 mShowSubstratum = !mShowSubstratum;
                 mApplications.rebuild(false);
                 break;
+            case R.id.show_substratum_icons:
+            case R.id.hide_substratum_icons:
+                mShowSubstratumIcons = !mShowSubstratumIcons;
+                mApplications.rebuild(false);
+                break;
             case R.id.reset_app_preferences:
                 mResetAppsHelper.buildResetDialog();
                 return true;
@@ -882,17 +897,17 @@ public void rebuild(boolean eraseold) {
             if (mOverrideFilter != null) {
                 filterObj = mOverrideFilter;
             }
-            if (!mManageApplications.mShowSystem && !mManageApplications.mShowSubstratum) {
-                filterObj = new CompoundFilter(filterObj,
-                        ApplicationsState.FILTER_DOWNLOADED_AND_LAUNCHER);
+            if (!mManageApplications.mShowSystem) {
                 filterObj = new CompoundFilter(filterObj,
-                        ApplicationsState.FILTER_SUBSTRATUM);
-            } else if (!mManageApplications.mShowSystem) {
+                                               ApplicationsState.FILTER_DOWNLOADED_AND_LAUNCHER);
+            }
+            if (!mManageApplications.mShowSubstratum) {
                 filterObj = new CompoundFilter(filterObj,
-                        ApplicationsState.FILTER_DOWNLOADED_AND_LAUNCHER);
-            } else if (!mManageApplications.mShowSubstratum) {
+                                               ApplicationsState.FILTER_SUBSTRATUM);
+            }
+            if (!mManageApplications.mShowSubstratumIcons) {
                 filterObj = new CompoundFilter(filterObj,
-                        ApplicationsState.FILTER_SUBSTRATUM);
+                                               ApplicationsState.FILTER_SUBSTRATUM_ICONS);
             }
             switch (mLastSortMode) {
                 case R.id.sort_order_size:

From 365366d97ff0ed012798ec90d33935e0492a0f5c Mon Sep 17 00:00:00 2001
From: Ivan Iskandar <iiiiskandar14@gmail.com>
Date: Fri, 9 Dec 2016 02:19:20 +0100
Subject: [PATCH 09/20] Exclude overlays from the app counter

This exclude overlays from the app counter that shows
in manage app summary.

idea from @KreAch3R

Change-Id: I8cd591dc89eb87057e8c2ae3b2cca2c76c34534b
---
 src/com/android/settings/applications/AppCounter.java         | 1 +
 src/com/android/settings/applications/ManageApplications.java | 6 ++++++
 2 files changed, 7 insertions(+)

diff --git a/src/com/android/settings/applications/AppCounter.java b/src/com/android/settings/applications/AppCounter.java
index fb8d5809e7..852358dca3 100644
--- a/src/com/android/settings/applications/AppCounter.java
+++ b/src/com/android/settings/applications/AppCounter.java
@@ -47,6 +47,7 @@ protected Integer doInBackground(Void... params) {
                 ParceledListSlice<ApplicationInfo> list =
                         mIpm.getInstalledApplications(PackageManager.GET_DISABLED_COMPONENTS
                                 | PackageManager.GET_DISABLED_UNTIL_USED_COMPONENTS
+                                | PackageManager.GET_META_DATA
                                 | (user.isAdmin() ? PackageManager.GET_UNINSTALLED_PACKAGES : 0),
                                 user.id);
                 for (ApplicationInfo info : list.getList()) {
diff --git a/src/com/android/settings/applications/ManageApplications.java b/src/com/android/settings/applications/ManageApplications.java
index 5d3b353766..ed617814b3 100644
--- a/src/com/android/settings/applications/ManageApplications.java
+++ b/src/com/android/settings/applications/ManageApplications.java
@@ -1297,6 +1297,12 @@ protected boolean includeInCount(ApplicationInfo info) {
                         if ((info.flags & ApplicationInfo.FLAG_UPDATED_SYSTEM_APP) != 0) {
                             return true;
                         } else if ((info.flags & ApplicationInfo.FLAG_SYSTEM) == 0) {
+                            if (info.metaData != null) {
+                                if (info.metaData.getString("Substratum_Parent") != null
+                                        || info.metaData.getString("Substratum_IconPack") != null) {
+                                    return false;
+                                }
+                            }
                             return true;
                         }
                         Intent launchIntent = new Intent(Intent.ACTION_MAIN, null)

From 533c2d70efab91ee1ec6bae0b77858c3bb4bc3be Mon Sep 17 00:00:00 2001
From: Ivan Iskandar <iiiiskandar14@gmail.com>
Date: Wed, 14 Dec 2016 14:58:54 +0100
Subject: [PATCH 10/20] Hide the "show/hide overlays" when no overlay installed

Change-Id: I54088d27c9492e0992992de59bf340fe2465260a
---
 .../settings/applications/ManageApplications.java  | 38 +++++++++++++++++++---
 1 file changed, 34 insertions(+), 4 deletions(-)

diff --git a/src/com/android/settings/applications/ManageApplications.java b/src/com/android/settings/applications/ManageApplications.java
index ed617814b3..c3bc4d4a94 100644
--- a/src/com/android/settings/applications/ManageApplications.java
+++ b/src/com/android/settings/applications/ManageApplications.java
@@ -195,6 +195,10 @@
     private boolean mShowSubstratum;
     private boolean mShowSubstratumIcons;
 
+    // if app and icon overlay installed
+    private boolean mAppOverlayInstalled;
+    private boolean mIconOverlayInstalled;
+
     private ApplicationsState mApplicationsState;
 
     public int mListType;
@@ -556,6 +560,9 @@ public void onDestroyOptionsMenu() {
     }
 
     void updateOptionsMenu() {
+        mAppOverlayInstalled = isOverlayInstalled("app");
+        mIconOverlayInstalled = isOverlayInstalled("icon");
+
         if (mOptionsMenu == null) {
             return;
         }
@@ -573,13 +580,13 @@ void updateOptionsMenu() {
                 && mListType != LIST_TYPE_HIGH_POWER);
 
         mOptionsMenu.findItem(R.id.show_substratum).setVisible(!mShowSubstratum
-                && mListType != LIST_TYPE_HIGH_POWER);
+                && mListType != LIST_TYPE_HIGH_POWER && mAppOverlayInstalled);
         mOptionsMenu.findItem(R.id.hide_substratum).setVisible(mShowSubstratum
-                && mListType != LIST_TYPE_HIGH_POWER);
+                && mListType != LIST_TYPE_HIGH_POWER && mAppOverlayInstalled);
         mOptionsMenu.findItem(R.id.show_substratum_icons).setVisible(!mShowSubstratumIcons
-                && mListType != LIST_TYPE_HIGH_POWER);
+                && mListType != LIST_TYPE_HIGH_POWER && mIconOverlayInstalled);
         mOptionsMenu.findItem(R.id.hide_substratum_icons).setVisible(mShowSubstratumIcons
-                && mListType != LIST_TYPE_HIGH_POWER);
+                && mListType != LIST_TYPE_HIGH_POWER && mIconOverlayInstalled);
     }
 
     @Override
@@ -668,6 +675,29 @@ public void setHasDisabled(boolean hasDisabledApps) {
         mFilterAdapter.setFilterEnabled(FILTER_APPS_DISABLED, hasDisabledApps);
     }
 
+    boolean isOverlayInstalled(String type) {
+        List<ApplicationInfo> packages = getActivity().getPackageManager()
+                .getInstalledApplications(PackageManager.GET_META_DATA);
+
+        for (ApplicationInfo packageInfo : packages) {
+            if (packageInfo.metaData != null) {
+                if (type.equals("app")) {
+                    if (packageInfo.metaData
+                                    .getString("Substratum_Parent") != null) {
+                        return true;
+                    }
+                }
+                if (type.equals("icon")) {
+                    if (packageInfo.metaData
+                                    .getString("Substratum_IconPack") != null) {
+                        return true;
+                    }
+                }
+            }
+        }
+        return false;
+    }
+
     static class FilterSpinnerAdapter extends ArrayAdapter<CharSequence> {
 
         private final ManageApplications mManageApplications;

From 6c425f785390fc672a1d66f06bd70bdbaef8cbfe Mon Sep 17 00:00:00 2001
From: Clark Scheff <clark@scheffsblend.com>
Date: Fri, 23 Dec 2016 09:52:57 -0500
Subject: [PATCH 11/20] Expose color for external settings icons

Marhsmallow now allows for system apps to add settings.  An icon is
loaded from the external package and a tint is applied to the icon
so that it matches other icons in the dashboard.  The tint color
uses the colorAccent attribute from the currently applied style.
Themes can overlay the colorAccent but this color is also used for
other elements of the UI which may not be ideal.

This patch adds a new color external_tile_icon_tint_color which
points to the attribute ?android:attr/colorAccent when not themed.
This retains the original look but offers better flexibility for
theme designers.

- Ported up to 7.1.1

Change-Id: Ifb4a99a315271cdcf978a796e3dea0eaef8d7750
---
 res/values/projekt_colors.xml                            |  4 +++-
 src/com/android/settings/dashboard/DashboardAdapter.java | 14 +++++++++-----
 2 files changed, 12 insertions(+), 6 deletions(-)

diff --git a/res/values/projekt_colors.xml b/res/values/projekt_colors.xml
index 27efb1d1a7..a58aa40f6b 100644
--- a/res/values/projekt_colors.xml
+++ b/res/values/projekt_colors.xml
@@ -39,9 +39,11 @@
     <color name="storage_private_3">#fff2a600</color>
     <color name="storage_private_4">#ffec407a</color>
     <color name="storage_private_5">#ffc0ca33</color>
-
     <!-- Linear color bar -->
     <color name="linear_color_bar_left">@*android:color/accent_device_default_light</color>
     <color name="linear_color_bar_middle">@*android:color/accent_device_default_light</color>
     <color name="linear_color_bar_right">#ffced7db</color>
+
+    <!-- External Icon Tint -->
+    <color name="external_tile_icon_tint_color">?android:attr/colorAccent</color>
 </resources>
diff --git a/src/com/android/settings/dashboard/DashboardAdapter.java b/src/com/android/settings/dashboard/DashboardAdapter.java
index 6b2e145dc3..c29da4308e 100755
--- a/src/com/android/settings/dashboard/DashboardAdapter.java
+++ b/src/com/android/settings/dashboard/DashboardAdapter.java
@@ -114,10 +114,10 @@ public void setCategoriesAndSuggestions(List<DashboardCategory> categories,
         mSuggestions = suggestions;
         mCategories = categories;
 
-        // TODO: Better place for tinting?
-        TypedValue tintColor = new TypedValue();
-        mContext.getTheme().resolveAttribute(com.android.internal.R.attr.colorAccent,
-                tintColor, true);
+        TypedValue tintColorValue = new TypedValue();
+        mContext.getResources().getValue(R.color.external_tile_icon_tint_color,
+                tintColorValue, true);
+
         for (int i = 0; i < categories.size(); i++) {
             for (int j = 0; j < categories.get(i).tiles.size(); j++) {
                 Tile tile = categories.get(i).tiles.get(j);
@@ -126,7 +126,11 @@ public void setCategoriesAndSuggestions(List<DashboardCategory> categories,
                         tile.intent.getComponent().getPackageName())) {
                     // If this drawable is coming from outside Settings, tint it to match the
                     // color.
-                    tile.icon.setTint(tintColor.data);
+                    if (tintColorValue.type == TypedValue.TYPE_ATTRIBUTE) {
+                        mContext.getTheme().resolveAttribute(tintColorValue.data,
+                                tintColorValue, true);
+                    }
+                    tile.icon.setTint(tintColorValue.data);
                 }
             }
         }

From 1557c138d19eec2c18d2b34264a4f85f31f9b6de Mon Sep 17 00:00:00 2001
From: Ivan Iskandar <iiiiskandar14@gmail.com>
Date: Sun, 8 Jan 2017 00:18:47 +0100
Subject: [PATCH 12/20] Expose dashboard category padding bottom

Change-Id: I5a0d3266bbe96dbe6a136f78ed84cb1ee0a6a19b
---
 res/layout/dashboard_category.xml |  2 +-
 res/values/projekt_dimens.xml     | 20 ++++++++++++++++++++
 2 files changed, 21 insertions(+), 1 deletion(-)
 create mode 100644 res/values/projekt_dimens.xml

diff --git a/res/layout/dashboard_category.xml b/res/layout/dashboard_category.xml
index 7836644806..86dac35d47 100644
--- a/res/layout/dashboard_category.xml
+++ b/res/layout/dashboard_category.xml
@@ -19,7 +19,7 @@
     android:layout_width="match_parent"
     android:layout_height="@dimen/dashboard_category_height"
     android:orientation="vertical"
-    android:paddingBottom="8dip"
+    android:paddingBottom="@dimen/dashboard_category_padding_bottom"
     android:background="@drawable/dashboard_category_title_bg">
 
     <TextView android:id="@android:id/title"
diff --git a/res/values/projekt_dimens.xml b/res/values/projekt_dimens.xml
new file mode 100644
index 0000000000..960c4943b6
--- /dev/null
+++ b/res/values/projekt_dimens.xml
@@ -0,0 +1,20 @@
+<?xml version="1.0" encoding="utf-8"?>
+<!--
+     Copyright (c) 2017 Projekt Substratum
+
+     Licensed under the Apache License, Version 2.0 (the "License");
+     you may not use this file except in compliance with the License.
+     You may obtain a copy of the License at
+
+         http://www.apache.org/licenses/LICENSE-2.0
+
+     Unless required by applicable law or agreed to in writing, software
+     distributed under the License is distributed on an "AS IS" BASIS,
+     WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+     See the License for the specific language governing permissions and
+     limitations under the License.
+-->
+
+<resources>
+    <dimen name="dashboard_category_padding_bottom">8dip</dimen>
+</resources>

From 7a88fe177420f4940198a7305419cf263103debd Mon Sep 17 00:00:00 2001
From: Ivan Iskandar <iiiiskandar14@gmail.com>
Date: Sun, 8 Jan 2017 01:22:47 +0100
Subject: [PATCH 13/20] Expose switchbar background color

Change-Id: Idc8b09c921bb57c9464d6ea956cfdd9b2b95e6a8
---
 res/values/projekt_colors.xml                  |  2 ++
 res/values/themes.xml                          |  4 ++--
 src/com/android/settings/widget/SwitchBar.java | 11 ++++++++++-
 3 files changed, 14 insertions(+), 3 deletions(-)

diff --git a/res/values/projekt_colors.xml b/res/values/projekt_colors.xml
index a58aa40f6b..09d691e98c 100644
--- a/res/values/projekt_colors.xml
+++ b/res/values/projekt_colors.xml
@@ -46,4 +46,6 @@
 
     <!-- External Icon Tint -->
     <color name="external_tile_icon_tint_color">?android:attr/colorAccent</color>
+    <!-- Settings switchbar background -->
+    <color name="switchbar_background_color">?android:attr/colorSecondary</color>
 </resources>
diff --git a/res/values/themes.xml b/res/values/themes.xml
index ffe802e2f2..acabe2195f 100644
--- a/res/values/themes.xml
+++ b/res/values/themes.xml
@@ -196,13 +196,13 @@
     <style name="ThemeOverlay.SwitchBar.Settings" parent="@*android:style/ThemeOverlay.DeviceDefault.Dark.ActionBar.Accent">
         <item name="switchBarMarginStart">@dimen/switchbar_subsettings_margin_start</item>
         <item name="switchBarMarginEnd">@dimen/switchbar_subsettings_margin_end</item>
-        <item name="switchBarBackgroundColor">?android:attr/colorSecondary</item>
+        <item name="switchBarBackgroundColor">@color/switchbar_background_color</item>
     </style>
 
     <style name="ThemeOverlay.SwitchBar.SubSettings" parent="@android:style/ThemeOverlay.Material.Dark.ActionBar">
         <item name="switchBarMarginStart">@dimen/switchbar_subsettings_margin_start</item>
         <item name="switchBarMarginEnd">@dimen/switchbar_subsettings_margin_end</item>
-        <item name="switchBarBackgroundColor">?android:attr/colorSecondary</item>
+        <item name="switchBarBackgroundColor">@color/switchbar_background_color</item>
     </style>
 
     <style name="Theme.DialogWhenLarge" parent="@*android:style/Theme.DeviceDefault.Settings.DialogWhenLarge">
diff --git a/src/com/android/settings/widget/SwitchBar.java b/src/com/android/settings/widget/SwitchBar.java
index 240c06296b..ce73a397f0 100644
--- a/src/com/android/settings/widget/SwitchBar.java
+++ b/src/com/android/settings/widget/SwitchBar.java
@@ -24,6 +24,7 @@
 import android.text.TextUtils;
 import android.text.style.TextAppearanceSpan;
 import android.util.AttributeSet;
+import android.util.TypedValue;
 import android.view.LayoutInflater;
 import android.view.View;
 import android.view.ViewGroup;
@@ -96,9 +97,17 @@ public SwitchBar(Context context, AttributeSet attrs, int defStyleAttr, int defS
         final TypedArray a = context.obtainStyledAttributes(attrs, XML_ATTRIBUTES);
         int switchBarMarginStart = (int) a.getDimension(0, 0);
         int switchBarMarginEnd = (int) a.getDimension(1, 0);
-        int switchBarBackgroundColor = (int) a.getColor(2, 0);
         a.recycle();
 
+        TypedValue backgroundColorValue = new TypedValue();
+        mContext.getResources().getValue(R.color.switchbar_background_color,
+                backgroundColorValue, true);
+        if (backgroundColorValue.type == TypedValue.TYPE_ATTRIBUTE) {
+            context.getTheme().resolveAttribute(backgroundColorValue.data,
+                    backgroundColorValue, true);
+        }
+        int switchBarBackgroundColor = backgroundColorValue.data;
+
         mTextView = (TextView) findViewById(R.id.switch_text);
         mTextView.setImportantForAccessibility(IMPORTANT_FOR_ACCESSIBILITY_NO);
         mLabel = getResources().getString(R.string.switch_off_text);

From c9fc9e76bbc7bf7b26a6eeb4ef71dc4ff6b094d4 Mon Sep 17 00:00:00 2001
From: SpiritCroc <spiritcroc@gmail.com>
Date: Sun, 22 Jan 2017 20:51:47 +0100
Subject: [PATCH 14/20] Settings: Expose bluetooth pin confirm dialog text
 colors

Change-Id: I1e1eb2da23f2470a82574da7ef326d56f770eb95
---
 res/layout/bluetooth_pin_confirm.xml | 6 +++---
 res/values/projekt_colors.xml        | 5 +++++
 2 files changed, 8 insertions(+), 3 deletions(-)

diff --git a/res/layout/bluetooth_pin_confirm.xml b/res/layout/bluetooth_pin_confirm.xml
index ebdf65de78..6609a1b70f 100644
--- a/res/layout/bluetooth_pin_confirm.xml
+++ b/res/layout/bluetooth_pin_confirm.xml
@@ -40,7 +40,7 @@
             android:text="@string/bluetooth_pairing_key_msg"
             android:visibility="gone"
             android:textAppearance="@android:style/TextAppearance.Material.Body1"
-            android:textColor="@*android:color/secondary_text_material_light"  />
+            android:textColor="@color/bluetooth_pairing_caption"  />
 
         <TextView
             android:id="@+id/pairing_subhead"
@@ -63,7 +63,7 @@
             android:gravity="center_vertical"
             android:text="@string/bluetooth_enter_passkey_msg"
             android:textAppearance="@android:style/TextAppearance.Material.Subhead"
-            android:textColor="@*android:color/secondary_text_material_light"
+            android:textColor="@color/bluetooth_pairing_code_message"
             android:visibility="gone" />
 
         <CheckBox
@@ -73,7 +73,7 @@
             android:layout_marginStart="@dimen/bluetooth_dialog_padding"
             android:layout_marginEnd="@dimen/bluetooth_dialog_padding"
             android:textAppearance="@android:style/TextAppearance.Material.Body1"
-            android:textColor="@*android:color/secondary_text_material_light"  />
+            android:textColor="@color/bluetooth_phonebook_sharing_message_confirm_pin"  />
 
     </LinearLayout>
 
diff --git a/res/values/projekt_colors.xml b/res/values/projekt_colors.xml
index 09d691e98c..ac786ac2cc 100644
--- a/res/values/projekt_colors.xml
+++ b/res/values/projekt_colors.xml
@@ -48,4 +48,9 @@
     <color name="external_tile_icon_tint_color">?android:attr/colorAccent</color>
     <!-- Settings switchbar background -->
     <color name="switchbar_background_color">?android:attr/colorSecondary</color>
+
+    <!-- Bluetooth pairing pin confirm dialog -->
+    <color name="bluetooth_pairing_caption">@*android:color/secondary_text_material_light</color>
+    <color name="bluetooth_pairing_code_message">@*android:color/secondary_text_material_light</color>
+    <color name="bluetooth_phonebook_sharing_message_confirm_pin">@*android:color/secondary_text_material_light</color>
 </resources>

From e81399a40955c2bd806ba312358a44df527e44bb Mon Sep 17 00:00:00 2001
From: Ivan Iskandar <iiiiskandar14@gmail.com>
Date: Sat, 28 Jan 2017 13:40:55 +0100
Subject: [PATCH 15/20] Set external settings icon tint mode to SRC_ATOP

With "Expose color for external settings icons" commit, themers can change
the color of the external settings icon to whatever they want except
transparent. When they set the tint color to transparent the icon will be
dissapeared, this commits fixed the problem by changing the tint mode.

Before: http://i.imgur.com/ghDPs27.jpg
After: http://i.imgur.com/AUEFgNO.jpg

Change-Id: I65b710e2abefd1052b3af154a98247de9b4fe98d
---
 src/com/android/settings/dashboard/DashboardAdapter.java | 3 ++-
 1 file changed, 2 insertions(+), 1 deletion(-)

diff --git a/src/com/android/settings/dashboard/DashboardAdapter.java b/src/com/android/settings/dashboard/DashboardAdapter.java
index c29da4308e..8259d39ee6 100755
--- a/src/com/android/settings/dashboard/DashboardAdapter.java
+++ b/src/com/android/settings/dashboard/DashboardAdapter.java
@@ -19,6 +19,7 @@
 import android.content.pm.PackageManager;
 import android.graphics.drawable.Drawable;
 import android.graphics.drawable.Icon;
+import android.graphics.PorterDuff.Mode;
 import android.os.Bundle;
 import android.support.v7.widget.PopupMenu;
 import android.support.v7.widget.RecyclerView;
@@ -130,7 +131,7 @@ public void setCategoriesAndSuggestions(List<DashboardCategory> categories,
                         mContext.getTheme().resolveAttribute(tintColorValue.data,
                                 tintColorValue, true);
                     }
-                    tile.icon.setTint(tintColorValue.data);
+                    tile.icon.setTint(tintColorValue.data).setTintMode(Mode.SRC_ATOP);
                 }
             }
         }

From ec2acdf59b34dde823eb4fd37fb7c573a6bd8206 Mon Sep 17 00:00:00 2001
From: Clark Scheff <clark@scheffsblend.com>
Date: Mon, 27 Feb 2017 00:55:37 +0100
Subject: [PATCH 16/20] Settings: Guard against themes without colorAccent
 defined

If an applied theme omits the colorAccent attribute in their style
AppOpsSummary will crash because typedValue.resourceId is 0.

Check if typedValue.resourceId is 0 and if so use switch_accent_color
for tab indicator color.

Change-Id: I2754a88a50277abb1b685183c0fb2e5b606eb451
---
 res/values/projekt_colors.xml                            | 3 +++
 src/com/android/settings/applications/AppOpsSummary.java | 4 +++-
 2 files changed, 6 insertions(+), 1 deletion(-)

diff --git a/res/values/projekt_colors.xml b/res/values/projekt_colors.xml
index ac786ac2cc..d7dc15bd83 100644
--- a/res/values/projekt_colors.xml
+++ b/res/values/projekt_colors.xml
@@ -53,4 +53,7 @@
     <color name="bluetooth_pairing_caption">@*android:color/secondary_text_material_light</color>
     <color name="bluetooth_pairing_code_message">@*android:color/secondary_text_material_light</color>
     <color name="bluetooth_phonebook_sharing_message_confirm_pin">@*android:color/secondary_text_material_light</color>
+
+    <!-- App ops -->
+    <color name="switch_accent_color">@*android:color/accent_device_default_light</color>
 </resources>
diff --git a/src/com/android/settings/applications/AppOpsSummary.java b/src/com/android/settings/applications/AppOpsSummary.java
index a86be734eb..cd534cd6ec 100644
--- a/src/com/android/settings/applications/AppOpsSummary.java
+++ b/src/com/android/settings/applications/AppOpsSummary.java
@@ -161,7 +161,9 @@ public View onCreateView(LayoutInflater inflater, ViewGroup container, Bundle sa
         Resources.Theme theme = tabs.getContext().getTheme();
         TypedValue typedValue = new TypedValue();
         theme.resolveAttribute(android.R.attr.colorAccent, typedValue, true);
-        final int colorAccent = getContext().getColor(typedValue.resourceId);
+        final int colorAccent = typedValue.resourceId != 0
+                ? getContext().getColor(typedValue.resourceId)
+                : getContext().getColor(R.color.switch_accent_color);
         tabs.setTabIndicatorColor(colorAccent);
 
         // We have to do this now because PreferenceFrameLayout looks at it

From 0ca8ea8faa6dbe8f38bf4ff21d3f75dea95a05f1 Mon Sep 17 00:00:00 2001
From: Bryan Owens <djbryan3540@gmail.com>
Date: Mon, 27 Feb 2017 20:02:56 -0600
Subject: [PATCH 17/20] Settings: Expose styles in the manifest for themes

Change-Id: Ib6999e21894acb2083b63e3f1f4a84f9d81ec9c1
Signed-off-by: Bryan Owens <djbryan3540@gmail.com>
---
 AndroidManifest.xml           | 50 +++++++++++++++++++++----------------------
 res/values/projekt_styles.xml | 30 ++++++++++++++++++++++++++
 2 files changed, 55 insertions(+), 25 deletions(-)
 create mode 100644 res/values/projekt_styles.xml

diff --git a/AndroidManifest.xml b/AndroidManifest.xml
index 3d8c98a0ae..8fb1b297a7 100755
--- a/AndroidManifest.xml
+++ b/AndroidManifest.xml
@@ -218,7 +218,7 @@
 
         <activity android:name="AirplaneModeVoiceActivity"
                 android:label="@string/wireless_networks_settings_title"
-                android:theme="@*android:style/Theme.DeviceDefault.Light.Voice"
+                android:theme="@style/Theme.VoiceActivity"
                 android:exported="true">
             <intent-filter>
                 <action android:name="android.settings.VOICE_CONTROL_AIRPLANE_MODE" />
@@ -392,7 +392,7 @@
                   android:exported="true"
                   android:permission="android.permission.CONNECTIVITY_INTERNAL"
                   android:taskAffinity=""
-                  android:theme="@*android:style/Theme.DeviceDefault.Light.Dialog.Alert">
+                  android:theme="@style/Theme.SettingsAlertDialog">
             <intent-filter>
                 <action android:name="android.net.conn.PROMPT_UNVALIDATED" />
                 <category android:name="android.intent.category.DEFAULT" />
@@ -600,7 +600,7 @@
 
         <activity android:name="DateTimeSettingsSetupWizard"
                   android:label="@string/date_and_time"
-                  android:theme="@android:style/Theme.DeviceDefault.Light.NoActionBar"
+                  android:theme="@style/Theme.DateTimeSettingsSetupWizard"
                   android:screenOrientation="behind">
             <intent-filter>
                 <action android:name="android.intent.action.MAIN" />
@@ -769,7 +769,7 @@
 
         <activity android:name=".inputmethod.UserDictionaryAddWordActivity"
                   android:label="@string/user_dict_settings_title"
-                  android:theme="@android:style/Theme.DeviceDefault.Light.Dialog.NoActionBar"
+                  android:theme="@style/Theme.SettingsDialog"
                   android:windowSoftInputMode="stateVisible"
                   android:noHistory="true"
                   android:excludeFromRecents="true">
@@ -1048,7 +1048,7 @@
 
         <activity android:name="SettingsLicenseActivity"
                 android:label="@string/settings_license_activity_title"
-                android:theme="@android:style/Theme.DeviceDefault.Light.Panel"
+                android:theme="@style/Theme.SettingsLicenseActivity"
                 android:configChanges="orientation|screenSize">
             <intent-filter android:priority="1">
                 <action android:name="android.settings.LICENSE" />
@@ -1167,7 +1167,7 @@
         <activity android:name=".fuelgauge.RequestIgnoreBatteryOptimizations"
                 android:label="@string/high_power_apps"
                 android:taskAffinity=""
-                android:theme="@*android:style/Theme.DeviceDefault.Light.Dialog.Alert">
+                android:theme="@style/Theme.SettingsAlertDialog">
             <intent-filter android:priority="1">
                 <action android:name="android.settings.REQUEST_IGNORE_BATTERY_OPTIMIZATIONS" />
                 <category android:name="android.intent.category.DEFAULT" />
@@ -1285,7 +1285,7 @@
         </activity>
 
         <activity android:name=".notification.ZenModeVoiceActivity"
-                android:theme="@android:style/Theme.DeviceDefault.Light.Dialog.NoActionBar"
+                android:theme="@style/Theme.SettingsDialog"
                 android:label="@string/zen_mode_settings_title">
             <intent-filter>
                 <action android:name="android.settings.VOICE_CONTROL_DO_NOT_DISTURB_MODE" />
@@ -2082,7 +2082,7 @@
         </activity-alias>
 
         <activity android:name=".AppPicker" android:label="@string/select_application"
-                android:theme="@android:style/Theme.DeviceDefault.Light.Dialog" />
+                android:theme="@style/Theme.AppPicker" />
 
         <!-- Keep compatibility with old shortcuts. -->
         <activity-alias android:name="UsbSettings"
@@ -2099,7 +2099,7 @@
                   android:label="@string/bluetooth_pairing_request"
                   android:excludeFromRecents="true"
                   android:windowSoftInputMode="stateVisible|adjustResize"
-                  android:theme="@*android:style/Theme.DeviceDefault.Light.Dialog.Alert">
+                  android:theme="@style/Theme.SettingsAlertDialog">
             <intent-filter android:priority="1">
                 <action android:name="android.bluetooth.device.action.PAIRING_REQUEST" />
                 <category android:name="android.intent.category.DEFAULT" />
@@ -2132,7 +2132,7 @@
                   android:label="@string/bluetooth_permission_request"
                   android:excludeFromRecents="true"
                   android:permission="android.permission.BLUETOOTH"
-                  android:theme="@*android:style/Theme.DeviceDefault.Light.Dialog.Alert">
+                  android:theme="@style/Theme.SettingsAlertDialog">
             <intent-filter android:priority="1">
                 <action android:name="android.bluetooth.adapter.action.REQUEST_DISCOVERABLE" />
                 <action android:name="android.bluetooth.adapter.action.REQUEST_ENABLE" />
@@ -2153,14 +2153,14 @@
                   android:excludeFromRecents="true"
                   android:exported="true"
                   android:permission="android.permission.MANAGE_USB"
-                  android:theme="@android:style/Theme.DeviceDefault.Light.Dialog.NoActionBar">
+                  android:theme="@style/Theme.SettingsDialog">
         </activity>
 
         <activity android:name=".RemoteBugreportActivity"
                   android:excludeFromRecents="true"
                   android:exported="true"
                   android:permission="android.permission.DUMP"
-                  android:theme="@android:style/Theme.DeviceDefault.Light.Dialog.NoActionBar">
+                  android:theme="@style/Theme.SettingsDialog">
             <intent-filter>
                 <action android:name="android.settings.SHOW_REMOTE_BUGREPORT_DIALOG" />
                 <category android:name="android.intent.category.DEFAULT" />
@@ -2171,7 +2171,7 @@
                   android:label="@string/bluetooth_pairing_request"
                   android:excludeFromRecents="true"
                   android:permission="android.permission.BLUETOOTH"
-                  android:theme="@*android:style/Theme.DeviceDefault.Light.Dialog.Alert">
+                  android:theme="@style/Theme.SettingsAlertDialog">
         </activity>
 
         <receiver android:name=".bluetooth.BluetoothPairingRequest">
@@ -2194,7 +2194,7 @@
                   android:label="@string/bluetooth_connection_permission_request"
                   android:excludeFromRecents="true"
                   android:permission="android.permission.BLUETOOTH_ADMIN"
-                  android:theme="@android:style/Theme.DeviceDefault.Light.Dialog.Alert">
+                  android:theme="@style/Theme.SettingsAlertDialog">
             <intent-filter android:priority="1">
                 <action android:name="android.bluetooth.device.action.CONNECTION_ACCESS_REQUEST" />
                 <action android:name="android.bluetooth.device.action.CONNECTION_ACCESS_CANCEL" />
@@ -2204,7 +2204,7 @@
 
         <activity android:name="ActivityPicker"
                 android:label="@string/activity_picker_label"
-                android:theme="@*android:style/Theme.DeviceDefault.Light.Dialog.Alert"
+                android:theme="@style/Theme.SettingsAlertDialog"
                 android:finishOnCloseSystemDialogs="true">
             <intent-filter android:priority="1">
                 <action android:name="android.intent.action.PICK_ACTIVITY" />
@@ -2267,7 +2267,7 @@
 
         <!-- TODO: Is this needed? -->
         <activity android:name="BandMode"
-                  android:theme="@android:style/Theme.DeviceDefault.Light.Dialog.Alert"
+                  android:theme="@style/Theme.SettingsAlertDialog"
                   android:process="com.android.phone">
             <intent-filter>
                 <action android:name="android.intent.action.MAIN" />
@@ -2295,7 +2295,7 @@
         <!-- Standard picker for widgets -->
         <activity android:name="AppWidgetPickActivity"
                 android:label="@string/widget_picker_title"
-                android:theme="@*android:style/Theme.DeviceDefault.Light.Dialog.Alert"
+                android:theme="@style/Theme.SettingsAlertDialog"
                 android:finishOnCloseSystemDialogs="true">
             <intent-filter android:priority="1">
                 <action android:name="android.appwidget.action.APPWIDGET_PICK" />
@@ -2304,7 +2304,7 @@
         </activity>
 
         <activity android:name="AllowBindAppWidgetActivity"
-                android:theme="@*android:style/Theme.DeviceDefault.Light.Dialog.Alert"
+                android:theme="@style/Theme.SettingsAlertDialog"
                 android:finishOnCloseSystemDialogs="true"
                 android:excludeFromRecents="true">
             <intent-filter android:priority="1">
@@ -2374,7 +2374,7 @@
 
         <activity android:name=".fuelgauge.BatterySaverModeVoiceActivity"
                 android:label="@string/power_usage_summary_title"
-                android:theme="@*android:style/Theme.DeviceDefault.Light.Voice"
+                android:theme="@style/Theme.VoiceActivity"
                 android:exported="true">
             <intent-filter>
                 <action android:name="android.settings.VOICE_CONTROL_BATTERY_SAVER_MODE" />
@@ -2610,7 +2610,7 @@
         <activity android:name=".nfc.PaymentDefaultDialog"
                   android:label="@string/nfc_payment_set_default_label"
                   android:excludeFromRecents="true"
-                  android:theme="@android:style/Theme.DeviceDefault.Light.Dialog.Alert">
+                  android:theme="@style/Theme.SettingsAlertDialog">
             <intent-filter android:priority="1">
                 <action android:name="android.nfc.cardemulation.action.ACTION_CHANGE_DEFAULT" />
                 <category android:name="android.intent.category.DEFAULT" />
@@ -2628,7 +2628,7 @@
         <activity android:name=".SmsDefaultDialog"
                   android:label="@string/sms_application_title"
                   android:excludeFromRecents="true"
-                  android:theme="@android:style/Theme.DeviceDefault.Light.Dialog.Alert">
+                  android:theme="@style/Theme.SettingsAlertDialog">
             <intent-filter android:priority="1">
                 <action android:name="android.provider.Telephony.ACTION_CHANGE_DEFAULT" />
                 <category android:name="android.intent.category.DEFAULT" />
@@ -2638,7 +2638,7 @@
         <activity android:name=".ActiveNetworkScorerDialog"
                   android:label="@string/wifi_assistant_title"
                   android:excludeFromRecents="true"
-                  android:theme="@android:style/Theme.DeviceDefault.Light.Dialog.Alert">
+                  android:theme="@style/Theme.SettingsAlertDialog">
             <intent-filter android:priority="1">
                 <action android:name="android.net.scoring.CHANGE_ACTIVE" />
                 <category android:name="android.intent.category.DEFAULT" />
@@ -2900,7 +2900,7 @@
         </activity>
 
         <activity android:name=".sim.SimPreferenceDialog"
-            android:theme="@android:style/Theme.DeviceDefault.Light.Dialog.NoActionBar"
+            android:theme="@style/Theme.SettingsDialog"
             android:excludeFromRecents="true">
         </activity>
 
@@ -2918,7 +2918,7 @@
         </activity>
 
         <activity android:name=".sim.SimDialogActivity"
-                android:theme="@android:style/Theme.DeviceDefault.Light.Dialog.NoActionBar"
+                android:theme="@style/Theme.SettingsDialog"
                 android:label="@string/sim_settings_title"
                 android:excludeFromRecents="true">
             <intent-filter>
@@ -3044,7 +3044,7 @@
         <activity android:name=".WebViewImplementation"
                   android:exported="true"
                   android:excludeFromRecents="true"
-                  android:theme="@*android:style/Theme.DeviceDefault.Light.Dialog.Alert">
+                  android:theme="@style/Theme.SettingsAlertDialog">
             <intent-filter>
                 <action android:name="android.settings.WEBVIEW_SETTINGS" />
                 <category android:name="android.intent.category.DEFAULT" />
diff --git a/res/values/projekt_styles.xml b/res/values/projekt_styles.xml
new file mode 100644
index 0000000000..54fc2b61fd
--- /dev/null
+++ b/res/values/projekt_styles.xml
@@ -0,0 +1,30 @@
+<?xml version="1.0" encoding="utf-8"?>
+<!--
+     Copyright (C) 2017 Projekt Substratum
+
+     Licensed under the Apache License, Version 2.0 (the "License");
+     you may not use this file except in compliance with the License.
+     You may obtain a copy of the License at
+
+          http://www.apache.org/licenses/LICENSE-2.0
+
+     Unless required by applicable law or agreed to in writing, software
+     distributed under the License is distributed on an "AS IS" BASIS,
+     WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+     See the License for the specific language governing permissions and
+     limitations under the License.
+-->
+
+<resources>
+    <style name="Theme.DateTimeSettingsSetupWizard" parent="@android:style/Theme.DeviceDefault.Light.NoActionBar" />
+
+    <style name="Theme.SettingsLicenseActivity" parent="@android:style/Theme.DeviceDefault.Light.Panel" />
+
+    <style name="Theme.AppPicker" parent="@android:style/Theme.DeviceDefault.Light.Dialog" />
+
+    <style name="Theme.SettingsDialog" parent="@android:style/Theme.DeviceDefault.Light.Dialog.NoActionBar" />
+
+    <style name="Theme.SettingsAlertDialog" parent="@*android:style/Theme.DeviceDefault.Light.Dialog.Alert" />
+
+    <style name="Theme.VoiceActivity" parent="@*android:style/Theme.DeviceDefault.Light.Voice" />
+</resources>

From cbfbb4eb4d2b7d0c9e907c492b99549bdc18b5e8 Mon Sep 17 00:00:00 2001
From: Randall Rushing <randall.rushing@gmail.com>
Date: Tue, 5 Apr 2016 11:24:26 -0500
Subject: [PATCH 18/20] Settings: Expose and add tint mode to custom icons

This allows themers to add custom icons and have them still show in
power usage detail

adding to this original commit: http://review.cyanogenmod.org/#/c/136136/

Change-Id: Id38035d8eaa4c3bd004fe747a5df3899646e5cdc
Signed-off-by: Bryan Owens <djbryan3540@gmail.com>
---
 res/values/projekt_colors.xml                            | 5 ++---
 src/com/android/settings/fuelgauge/PowerUsageDetail.java | 7 +++++--
 2 files changed, 7 insertions(+), 5 deletions(-)

diff --git a/res/values/projekt_colors.xml b/res/values/projekt_colors.xml
index d7dc15bd83..f5c092198e 100644
--- a/res/values/projekt_colors.xml
+++ b/res/values/projekt_colors.xml
@@ -43,17 +43,16 @@
     <color name="linear_color_bar_left">@*android:color/accent_device_default_light</color>
     <color name="linear_color_bar_middle">@*android:color/accent_device_default_light</color>
     <color name="linear_color_bar_right">#ffced7db</color>
-
     <!-- External Icon Tint -->
     <color name="external_tile_icon_tint_color">?android:attr/colorAccent</color>
     <!-- Settings switchbar background -->
     <color name="switchbar_background_color">?android:attr/colorSecondary</color>
-
     <!-- Bluetooth pairing pin confirm dialog -->
     <color name="bluetooth_pairing_caption">@*android:color/secondary_text_material_light</color>
     <color name="bluetooth_pairing_code_message">@*android:color/secondary_text_material_light</color>
     <color name="bluetooth_phonebook_sharing_message_confirm_pin">@*android:color/secondary_text_material_light</color>
-
     <!-- App ops -->
     <color name="switch_accent_color">@*android:color/accent_device_default_light</color>
+    <!-- Power Usage Hard colors-->
+    <color name="power_usage_ab_icon_tint">@android:color/white</color>
 </resources>
diff --git a/src/com/android/settings/fuelgauge/PowerUsageDetail.java b/src/com/android/settings/fuelgauge/PowerUsageDetail.java
index f091f6649e..eae0ca14e9 100644
--- a/src/com/android/settings/fuelgauge/PowerUsageDetail.java
+++ b/src/com/android/settings/fuelgauge/PowerUsageDetail.java
@@ -29,6 +29,7 @@
 import android.content.pm.PackageManager;
 import android.content.pm.PackageManager.NameNotFoundException;
 import android.graphics.drawable.Drawable;
+import android.graphics.PorterDuff;
 import android.net.Uri;
 import android.os.BatteryStats;
 import android.os.Bundle;
@@ -481,12 +482,14 @@ private void setupHeader() {
         if (appIcon == null) {
             appIcon = getActivity().getPackageManager().getDefaultActivityIcon();
         }
-
+        if (appIcon != null) {
+            appIcon.setTintMode(PorterDuff.Mode.SRC_ATOP);
+        }
         if (pkg == null && mPackages != null) {
             pkg = mPackages[0];
         }
         AppHeader.createAppHeader(this, appIcon, title, pkg, uid,
-                mDrainType != DrainType.APP ? android.R.color.white : 0);
+                mDrainType != DrainType.APP ? R.color.power_usage_ab_icon_tint : 0);
     }
 
     public void onClick(View v) {

From 092c6ecdaceaf7bc4cc9468ce8f9cf7570b30e6a Mon Sep 17 00:00:00 2001
From: Bryan Owens <djbryan3540@gmail.com>
Date: Mon, 27 Feb 2017 22:24:09 -0600
Subject: [PATCH 19/20] Settings: Expose "ALL" hardcoded and @android colors

Change-Id: Iac46ea78387881e2237c3b9fb302c84987fe94f3
Signed-off-by: Bryan Owens <djbryan3540@gmail.com>
---
 res/layout-sw600dp/nfc_payment_how_it_works.xml        | 12 ++++++------
 res/layout/app_header.xml                              |  2 +-
 res/layout/crypt_keeper_emergency_button.xml           |  2 +-
 res/layout/crypt_keeper_status.xml                     |  4 ++--
 res/layout/data_usage_chart.xml                        |  4 ++--
 res/layout/filter_spinner_item.xml                     |  2 +-
 res/layout/master_clear_disallowed_screen.xml          |  4 ++--
 res/layout/multi_sim_dialog.xml                        |  6 +++---
 res/layout/network_reset_disallowed_screen.xml         |  4 ++--
 res/layout/nfc_payment_how_it_works.xml                | 12 ++++++------
 res/layout/permission_settings.xml                     |  2 +-
 res/layout/preference_importance_slider.xml            |  2 +-
 res/layout/settings_color_picker_item.xml              |  2 +-
 res/layout/storage_internal_format.xml                 |  2 +-
 res/layout/storage_wizard_navigation.xml               |  2 +-
 res/values/projekt_colors.xml                          | 18 ++++++++++++++++++
 .../android/settings/deviceinfo/StorageSettings.java   |  2 ++
 .../settings/deviceinfo/StorageVolumePreference.java   |  2 ++
 18 files changed, 53 insertions(+), 31 deletions(-)

diff --git a/res/layout-sw600dp/nfc_payment_how_it_works.xml b/res/layout-sw600dp/nfc_payment_how_it_works.xml
index 3bee160406..5d71e1a25e 100644
--- a/res/layout-sw600dp/nfc_payment_how_it_works.xml
+++ b/res/layout-sw600dp/nfc_payment_how_it_works.xml
@@ -3,7 +3,7 @@
     android:id="@+id/trusted_devices_prompt_layout"
     android:layout_width="match_parent"
     android:layout_height="match_parent"
-    android:background="#FF80CBC4" >
+    android:background="@color/nfc_how_it_works_main_background" >
 
     <RelativeLayout
         android:layout_width="match_parent"
@@ -12,7 +12,7 @@
         <LinearLayout
             android:layout_width="match_parent"
             android:layout_height="336dp"
-            android:background="#FFB2DFDB" >
+            android:background="@color/nfc_how_it_works_background" >
         </LinearLayout>
 
         <LinearLayout
@@ -37,7 +37,7 @@
               android:layout_width="420dp"
               android:layout_height="wrap_content"
               android:text="@string/nfc_how_it_works_title"
-              android:textColor="#FF263238"
+              android:textColor="@color/nfc_how_it_works_title_text_color"
               android:textSize="24sp" />
 
           <TextView
@@ -47,14 +47,14 @@
               android:paddingTop="10dp"
               android:paddingBottom="18dp"
               android:text="@string/nfc_how_it_works_content"
-              android:textColor="#FF263238"
+              android:textColor="@color/nfc_how_it_works_content_text_color"
               android:textSize="20sp" />
         </LinearLayout>
         <RelativeLayout
             android:layout_width="match_parent"
             android:layout_height="48dp"
             android:layout_alignParentBottom="true"
-            android:background="#FFB2DFDB" >
+            android:background="@color/nfc_how_it_works_footer_background" >
           <Button
               android:id="@+id/nfc_how_it_works_button"
               android:background="?android:attr/selectableItemBackground"
@@ -64,7 +64,7 @@
               android:layout_marginRight="20dp"
               android:text="@string/nfc_how_it_works_got_it"
               android:textSize="14sp"
-              android:textColor="#263238"
+              android:textColor="@color/nfc_how_it_works_got_it_text_color"
               style="?android:attr/borderlessButtonStyle" />
         </RelativeLayout>
     </RelativeLayout>
diff --git a/res/layout/app_header.xml b/res/layout/app_header.xml
index 2d8a099be7..bbce9438c0 100644
--- a/res/layout/app_header.xml
+++ b/res/layout/app_header.xml
@@ -36,7 +36,7 @@
         android:layout_alignWithParentIfMissing="true"
         android:layout_centerVertical="true"
         android:textAppearance="@style/TextAppearance.Switch"
-        android:textColor="@android:color/white"
+        android:textColor="@color/text_color_white"
         android:textAlignment="viewStart" />
 
     <ImageView
diff --git a/res/layout/crypt_keeper_emergency_button.xml b/res/layout/crypt_keeper_emergency_button.xml
index 0b6f810b62..cf353152bf 100644
--- a/res/layout/crypt_keeper_emergency_button.xml
+++ b/res/layout/crypt_keeper_emergency_button.xml
@@ -33,7 +33,7 @@
         android:layout_gravity="center_horizontal"
         android:textSize="14sp"
         android:fontFamily="sans-serif"
-        android:textColor="#FFFFFF"
+        android:textColor="@color/emergency_call_button_text_color"
         style="?android:attr/borderlessButtonStyle" />
 
 </LinearLayout>
diff --git a/res/layout/crypt_keeper_status.xml b/res/layout/crypt_keeper_status.xml
index bddff1ad57..fd9f82e4fd 100644
--- a/res/layout/crypt_keeper_status.xml
+++ b/res/layout/crypt_keeper_status.xml
@@ -35,7 +35,7 @@
         android:layout_marginEnd="8dip"
         android:textSize="16sp"
         android:fontFamily="sans-serif"
-        android:textColor="@android:color/white"
+        android:textColor="@color/text_color_white"
         android:text="@string/enter_password"
         android:layout_gravity="center_horizontal"
         android:gravity="center_horizontal" />
@@ -52,7 +52,7 @@
         android:marqueeRepeatLimit ="marquee_forever"
         android:textSize="16sp"
         android:fontFamily="sans-serif"
-        android:textColor="#B3FFFFFF"
+        android:textColor="@color/owner_info_text_color"
         android:gravity="center_horizontal" />
 
 </LinearLayout>
diff --git a/res/layout/data_usage_chart.xml b/res/layout/data_usage_chart.xml
index c87a006a94..324d09fa5a 100644
--- a/res/layout/data_usage_chart.xml
+++ b/res/layout/data_usage_chart.xml
@@ -44,7 +44,7 @@
         android:layout_gravity="start|bottom"
         settings:strokeColor="#00000000"
         settings:fillColor="?android:attr/colorAccent"
-        settings:fillColorSecondary="#ff80cbc4"
+        settings:fillColorSecondary="@color/data_usage_chart_series_fill_Color_Secondary"
         settings:safeRegion="3dp" />
 
     <com.android.settings.widget.ChartNetworkSeriesView
@@ -102,7 +102,7 @@
         settings:neighborMargin="5dip"
         settings:labelSize="60dip"
         settings:labelTemplate="@string/data_usage_sweep_limit"
-        settings:labelColor="#fff4511e"
+        settings:labelColor="@color/data_usage_sweep_limit_label_Color"
         settings:safeRegion="4dp" />
 
 </com.android.settings.widget.ChartDataUsageView>
diff --git a/res/layout/filter_spinner_item.xml b/res/layout/filter_spinner_item.xml
index e83dd8071e..6b7bdb85f7 100644
--- a/res/layout/filter_spinner_item.xml
+++ b/res/layout/filter_spinner_item.xml
@@ -23,5 +23,5 @@
     android:layout_height="wrap_content"
     android:ellipsize="marquee"
     android:textAppearance="@style/TextAppearance.Switch"
-    android:textColor="@android:color/white"
+    android:textColor="@color/text_color_white"
     android:textAlignment="inherit"/>
diff --git a/res/layout/master_clear_disallowed_screen.xml b/res/layout/master_clear_disallowed_screen.xml
index 80326caeaf..ce14f46216 100644
--- a/res/layout/master_clear_disallowed_screen.xml
+++ b/res/layout/master_clear_disallowed_screen.xml
@@ -26,8 +26,8 @@
                 android:layout_height="match_parent"
                 android:drawSelectorOnTop="false"
                 android:scrollbarStyle="insideOverlay"
-                android:background="@android:color/white"
-                android:cacheColorHint="@android:color/white"
+                android:background="@color/background_color_white"
+                android:cacheColorHint="@color/background_color_white"
                 android:fadingEdgeLength="16dip" />
 
         <TextView android:id="@android:id/empty"
diff --git a/res/layout/multi_sim_dialog.xml b/res/layout/multi_sim_dialog.xml
index d0e7df8758..02643accd2 100644
--- a/res/layout/multi_sim_dialog.xml
+++ b/res/layout/multi_sim_dialog.xml
@@ -44,7 +44,7 @@
                     android:hint="@string/sim_name_hint"
                     android:inputType="textNoSuggestions"
                     android:maxLength="@integer/sim_name_length"
-                    android:textColor="@android:color/black"
+                    android:textColor="@color/text_color_black"
                     style="?android:attr/textAppearanceMedium" />
 
         </LinearLayout>
@@ -82,7 +82,7 @@
                     android:text="@string/sim_editor_carrier" />
 
             <TextView android:id="@+id/carrier"
-                    android:textColor="@android:color/black"
+                    android:textColor="@color/text_color_black"
                     android:layout_width="match_parent"
                     android:layout_height="wrap_content"
                     android:paddingStart="@dimen/sim_content_padding"
@@ -110,7 +110,7 @@
                     android:paddingBottom="@dimen/sim_dialog_margin_bottom"
                     android:paddingStart="@dimen/sim_content_padding"
                     android:singleLine="true"
-                    android:textColor="@android:color/black"
+                    android:textColor="@color/text_color_black"
                     style="?android:attr/textAppearanceMedium" />
 
         </LinearLayout>
diff --git a/res/layout/network_reset_disallowed_screen.xml b/res/layout/network_reset_disallowed_screen.xml
index 04f6fc2b4b..e72708bf27 100644
--- a/res/layout/network_reset_disallowed_screen.xml
+++ b/res/layout/network_reset_disallowed_screen.xml
@@ -26,8 +26,8 @@
                 android:layout_height="match_parent"
                 android:drawSelectorOnTop="false"
                 android:scrollbarStyle="insideOverlay"
-                android:background="@android:color/white"
-                android:cacheColorHint="@android:color/white"
+                android:background="@color/background_color_white"
+                android:cacheColorHint="@color/background_color_white"
                 android:fadingEdgeLength="16dip" />
 
         <TextView android:id="@android:id/empty"
diff --git a/res/layout/nfc_payment_how_it_works.xml b/res/layout/nfc_payment_how_it_works.xml
index 565a16b7d7..a870e5b265 100644
--- a/res/layout/nfc_payment_how_it_works.xml
+++ b/res/layout/nfc_payment_how_it_works.xml
@@ -3,7 +3,7 @@
     android:id="@+id/trusted_devices_prompt_layout"
     android:layout_width="match_parent"
     android:layout_height="match_parent"
-    android:background="#FF80CBC4" >
+    android:background="@color/nfc_how_it_works_main_background" >
 
     <RelativeLayout
         android:layout_width="match_parent"
@@ -12,7 +12,7 @@
         <LinearLayout
             android:layout_width="match_parent"
             android:layout_height="200dp"
-            android:background="#FFB2DFDB" >
+            android:background="@color/nfc_how_it_works_background" >
         </LinearLayout>
 
         <LinearLayout
@@ -38,7 +38,7 @@
               android:text="@string/nfc_how_it_works_title"
               android:paddingLeft="16dp"
               android:paddingRight="16dp"
-              android:textColor="#FF263238"
+              android:textColor="@color/nfc_how_it_works_title_text_color"
               android:textSize="24sp" />
 
           <TextView
@@ -50,14 +50,14 @@
               android:paddingLeft="16dp"
               android:paddingRight="16dp"
               android:text="@string/nfc_how_it_works_content"
-              android:textColor="#FF263238"
+              android:textColor="@color/nfc_how_it_works_content_text_color"
               android:textSize="16sp" />
         </LinearLayout>
         <RelativeLayout
             android:layout_width="match_parent"
             android:layout_height="48dp"
             android:layout_alignParentBottom="true"
-            android:background="#FFB2DFDB" >
+            android:background="@color/nfc_how_it_works_footer_background" >
           <Button
               android:id="@+id/nfc_how_it_works_button"
               android:background="?android:attr/selectableItemBackground"
@@ -67,7 +67,7 @@
               android:layout_marginRight="20dp"
               android:text="@string/nfc_how_it_works_got_it"
               android:textSize="14sp"
-              android:textColor="#263238"
+              android:textColor="@color/nfc_how_it_works_got_it_text_color"
               style="?android:attr/borderlessButtonStyle" />
         </RelativeLayout>
     </RelativeLayout>
diff --git a/res/layout/permission_settings.xml b/res/layout/permission_settings.xml
index f08b9d64f3..2067c02f14 100644
--- a/res/layout/permission_settings.xml
+++ b/res/layout/permission_settings.xml
@@ -43,7 +43,7 @@
                 android:text="@string/permissions_label" />
             <TextView android:id="@+id/security_settings_billing_desc"
                 android:text="@string/security_settings_billing_desc"
-                android:textColor="#ffffb060"
+                android:textColor="@color/security_settings_billing_desc_text_color"
                 android:textAppearance="?android:attr/textAppearanceSmall"
                 android:paddingTop="6dip"
                 android:paddingBottom="6dip"
diff --git a/res/layout/preference_importance_slider.xml b/res/layout/preference_importance_slider.xml
index 38618079bb..7e340f952f 100644
--- a/res/layout/preference_importance_slider.xml
+++ b/res/layout/preference_importance_slider.xml
@@ -61,7 +61,7 @@
                 android:thumbTint="?android:attr/colorAccent"
                 android:progressTint="?android:attr/colorAccent"
                 style="@android:style/Widget.Material.SeekBar.Discrete"
-                android:tickMarkTint="@android:color/black" />
+                android:tickMarkTint="@color/importance_secondary_slider_tickMarkTint_color" />
 
     </FrameLayout>
 
diff --git a/res/layout/settings_color_picker_item.xml b/res/layout/settings_color_picker_item.xml
index c171950d18..d8fc8c1f97 100644
--- a/res/layout/settings_color_picker_item.xml
+++ b/res/layout/settings_color_picker_item.xml
@@ -41,7 +41,7 @@
         android:paddingBottom="8dp"
         android:paddingRight="8dp"
         android:paddingLeft="8dp"
-        android:textColor="@android:color/black"
+        android:textColor="@color/text_color_black"
         style="?android:attr/textAppearanceMedium" />
 
 </LinearLayout>
\ No newline at end of file
diff --git a/res/layout/storage_internal_format.xml b/res/layout/storage_internal_format.xml
index 8aec28f9ab..c90ed285f4 100644
--- a/res/layout/storage_internal_format.xml
+++ b/res/layout/storage_internal_format.xml
@@ -46,7 +46,7 @@
             android:layout_width="match_parent"
             android:layout_height="wrap_content"
             android:text="@string/storage_menu_format"
-            android:textColor="@android:color/white"
+            android:textColor="@color/text_color_white"
             android:backgroundTint="@color/storage_wizard_button_red" />
     </FrameLayout>
 
diff --git a/res/layout/storage_wizard_navigation.xml b/res/layout/storage_wizard_navigation.xml
index 94f9bafef2..191d4f2208 100644
--- a/res/layout/storage_wizard_navigation.xml
+++ b/res/layout/storage_wizard_navigation.xml
@@ -46,7 +46,7 @@
         android:layout_marginBottom="16dp"
         android:layout_marginEnd="16dp"
         android:text="@string/wizard_next"
-        android:textColor="@android:color/white"
+        android:textColor="@color/text_color_white"
         android:backgroundTint="@color/storage_wizard_button" />
 
 </LinearLayout>
diff --git a/res/values/projekt_colors.xml b/res/values/projekt_colors.xml
index f5c092198e..8d66eac2f6 100644
--- a/res/values/projekt_colors.xml
+++ b/res/values/projekt_colors.xml
@@ -55,4 +55,22 @@
     <color name="switch_accent_color">@*android:color/accent_device_default_light</color>
     <!-- Power Usage Hard colors-->
     <color name="power_usage_ab_icon_tint">@android:color/white</color>
+    <!-- NFC hard colors -->
+    <color name="nfc_how_it_works_main_background">#FF80CBC4</color>
+    <color name="nfc_how_it_works_background">#FFB2DFDB</color>
+    <color name="nfc_how_it_works_title_text_color">#FF263238</color>
+    <color name="nfc_how_it_works_content_text_color">#FF263238</color>
+    <color name="nfc_how_it_works_footer_background">#FFB2DFDB</color>
+    <color name="nfc_how_it_works_got_it_text_color">#263238</color>
+    <!-- Permission Settings Hard colors-->
+    <color name="security_settings_billing_desc_text_color">#ffffb060</color>
+    <!-- Misc Hard colors-->
+    <color name="importance_secondary_slider_tickMarkTint_color">@android:color/black</color>
+    <color name="emergency_call_button_text_color">#ffffff</color>
+    <color name="owner_info_text_color">#B3FFFFFF</color>
+    <color name="data_usage_chart_series_fill_Color_Secondary">#ff80cbc4</color>
+    <color name="data_usage_sweep_limit_label_Color">#fff4511e</color>
+    <color name="text_color_black">@android:color/black</color>
+    <color name="text_color_white">@android:color/white</color>
+    <color name="background_color_white">@android:color/white</color>
 </resources>
diff --git a/src/com/android/settings/deviceinfo/StorageSettings.java b/src/com/android/settings/deviceinfo/StorageSettings.java
index a7cc2597b4..5eca6e33db 100755
--- a/src/com/android/settings/deviceinfo/StorageSettings.java
+++ b/src/com/android/settings/deviceinfo/StorageSettings.java
@@ -27,6 +27,7 @@
 import android.content.res.Resources ;
 import android.graphics.Color;
 import android.graphics.drawable.Drawable;
+import android.graphics.PorterDuff;
 import android.os.AsyncTask;
 import android.os.Bundle;
 import android.os.UserHandle;
@@ -208,6 +209,7 @@ private void refresh() {
                 final Drawable icon = context.getDrawable(R.drawable.ic_sim_sd);
                 icon.mutate();
                 icon.setTint(getColorPublic(getResources()));
+                icon.setTintMode(PorterDuff.Mode.SRC_ATOP);
 
                 final Preference pref = new Preference(context);
                 pref.setKey(rec.getFsUuid());
diff --git a/src/com/android/settings/deviceinfo/StorageVolumePreference.java b/src/com/android/settings/deviceinfo/StorageVolumePreference.java
index 8a2780a90b..a6c227c2cd 100644
--- a/src/com/android/settings/deviceinfo/StorageVolumePreference.java
+++ b/src/com/android/settings/deviceinfo/StorageVolumePreference.java
@@ -20,6 +20,7 @@
 import android.content.res.ColorStateList;
 import android.graphics.Color;
 import android.graphics.drawable.Drawable;
+import android.graphics.PorterDuff;
 import android.os.storage.StorageManager;
 import android.os.storage.VolumeInfo;
 import android.support.v7.preference.Preference;
@@ -100,6 +101,7 @@ public StorageVolumePreference(Context context, VolumeInfo volume, int color, lo
 
         icon.mutate();
         icon.setTint(mColor);
+        icon.setTintMode(PorterDuff.Mode.SRC_ATOP);
         setIcon(icon);
 
         if (volume.getType() == VolumeInfo.TYPE_PUBLIC

From da82a82bb464ead41f153c21000a4aa5bf6e1554 Mon Sep 17 00:00:00 2001
From: George G <kreach3r@users.noreply.github.com>
Date: Sat, 25 Feb 2017 18:24:06 +0200
Subject: [PATCH 20/20] Development: Allow all Masquerade calling packages for
 debugging (3/3)

It is also only allowed for Owner accounts.

Change-Id: I4d8ca60ead6fe058e7bc2ef8b7613e77457b3f27
---
 res/values/projekt_strings.xml                    |  4 ++++
 res/xml/development_prefs.xml                     |  5 +++++
 src/com/android/settings/DevelopmentSettings.java | 20 ++++++++++++++++++++
 3 files changed, 29 insertions(+)

diff --git a/res/values/projekt_strings.xml b/res/values/projekt_strings.xml
index 004e268b9c..5641da3d35 100644
--- a/res/values/projekt_strings.xml
+++ b/res/values/projekt_strings.xml
@@ -25,4 +25,8 @@
    <string name="menu_show_substratum_icons">Show icon overlays</string>
    <string name="menu_hide_substratum_icons">Hide icon overlays</string>
 
+   <!-- Force authorize substratum packages -->
+   <string name="force_authorize_substratum_packages_title">Force authorize every theme app</string>
+   <string name="force_authorize_substratum_packages_summary">Allow theme apps from unknown sources</string>
+
 </resources>
diff --git a/res/xml/development_prefs.xml b/res/xml/development_prefs.xml
index 1e7ed4a2b9..d654829ca1 100644
--- a/res/xml/development_prefs.xml
+++ b/res/xml/development_prefs.xml
@@ -210,6 +210,11 @@
             android:entries="@array/select_logpersist_titles"
             android:entryValues="@array/select_logpersist_values" />
 
+        <SwitchPreference
+            android:key="force_authorize_substratum_packages"
+            android:title="@string/force_authorize_substratum_packages_title"
+            android:summary="@string/force_authorize_substratum_packages_summary" />
+
     </PreferenceCategory>
 
     <PreferenceCategory android:key="debug_networking_category"
diff --git a/src/com/android/settings/DevelopmentSettings.java b/src/com/android/settings/DevelopmentSettings.java
index 10e0b73447..e2c0a46b44 100644
--- a/src/com/android/settings/DevelopmentSettings.java
+++ b/src/com/android/settings/DevelopmentSettings.java
@@ -235,6 +235,8 @@
 
     private static final String DEVELOPMENT_TOOLS = "development_tools";
 
+    private static final String FORCE_AUTHORIZE_SUBSTRATUM_PACKAGES = "force_authorize_substratum_packages";
+
     private static final int RESULT_DEBUG_APP = 1000;
     private static final int RESULT_MOCK_LOCATION_APP = 1001;
 
@@ -261,6 +263,8 @@
     private boolean mHaveDebugSettings;
     private boolean mDontPokeProperties;
 
+    private SwitchPreference mForceAuthorizeSubstratumPackages;
+
     private SwitchPreference mEnableAdb;
     private SwitchPreference mAdbOverNetwork;
     private Preference mClearAdbKeys;
@@ -427,6 +431,7 @@ public void onCreate(Bundle icicle) {
         mForceAllowOnExternal = findAndInitSwitchPref(FORCE_ALLOW_ON_EXTERNAL_KEY);
         mPassword = (PreferenceScreen) findPreference(LOCAL_BACKUP_PASSWORD);
         mAllPrefs.add(mPassword);
+        mForceAuthorizeSubstratumPackages = findAndInitSwitchPref(FORCE_AUTHORIZE_SUBSTRATUM_PACKAGES);
 
         if (!mUm.isAdminUser()) {
             disableForUser(mEnableAdb);
@@ -434,6 +439,7 @@ public void onCreate(Bundle icicle) {
             disableForUser(mEnableTerminal);
             disableForUser(mPassword);
             disableForUser(mUpdateRecoveryPreference);
+            disableForUser(mForceAuthorizeSubstratumPackages);
         }
 
         mDebugAppPref = findPreference(DEBUG_APP_KEY);
@@ -814,6 +820,7 @@ private void updateAllOptions() {
         updateRootAccessOptions();
         updateAdbOverNetwork();
         updateUpdateRecoveryOptions();
+        updateForceAuthorizeSubstratumPackagesOptions();
     }
 
     private void updateAdbOverNetwork() {
@@ -844,6 +851,17 @@ private void updateAdbOverNetwork() {
         }
     }
 
+    private void writeForceAuthorizeSubstratumPackagesOptions() {
+        Settings.Secure.putInt(getActivity().getContentResolver(),
+                Settings.Secure.FORCE_AUTHORIZE_SUBSTRATUM_PACKAGES,
+                mForceAuthorizeSubstratumPackages.isChecked() ? 1 : 0);
+    }
+
+    private void updateForceAuthorizeSubstratumPackagesOptions() {
+        mForceAuthorizeSubstratumPackages.setChecked(Settings.Secure.getInt(getActivity().getContentResolver(),
+                Settings.Secure.FORCE_AUTHORIZE_SUBSTRATUM_PACKAGES, 0) != 0);
+    }
+
     private void resetDangerousOptions() {
         mDontPokeProperties = true;
         for (int i=0; i< mResetSwitchPrefs.size(); i++) {
@@ -2255,6 +2273,8 @@ public boolean onPreferenceTreeClick(Preference preference) {
             writeUSBAudioOptions();
         } else if (preference == mForceResizable) {
             writeForceResizableOptions();
+        } else if (preference == mForceAuthorizeSubstratumPackages) {
+            writeForceAuthorizeSubstratumPackagesOptions();
         } else if (INACTIVE_APPS_KEY.equals(preference.getKey())) {
             startInactiveAppsFragment();
         } else if (BACKGROUND_CHECK_KEY.equals(preference.getKey())) {

