From 0622d6cfe87d4ed9440cc3992dcef0ea12771f34 Mon Sep 17 00:00:00 2001
From: Nathan Chancellor <natechancellor@gmail.com>
Date: Tue, 25 Apr 2017 01:59:38 -0700
Subject: [PATCH] Introduce Substratum manifest and update README

Change-Id: I603a7f8f94efdf585b653836e68abc65d1ba7075
Signed-off-by: Nathan Chancellor <natechancellor@gmail.com>
---
 README.mkdn             | 46 ++++++++++------------------------------------
 default.xml             |  3 +++
 snippets/substratum.xml | 31 +++++++++++++++++++++++++++++++
 3 files changed, 44 insertions(+), 36 deletions(-)
 create mode 100644 snippets/substratum.xml

diff --git a/README.mkdn b/README.mkdn
index 85386971..cae40d15 100644
--- a/README.mkdn
+++ b/README.mkdn
@@ -1,29 +1,10 @@
-LineageOS
-===========
+LineageOMS
+==========
 
-Submitting Patches
-------------------
-
-Patches are always welcome!  Please submit your patches via LineageOS Gerrit.
-You can do this by using these commands:
-
-    (From root android directory)
-    . build/envsetup.sh
-    (Go to repo you are patching, make your changes and commit)
-    cmgerrit <for(new)/changes(patch set)> <branch/change-id>
-
-    repo start cm-14.1 .
-    (Make your changes and commit)
-    repo upload .
-
-Note: "." means the current directory
-For more help on using this tool, use this command: `repo help upload`
-
-Make your changes and commit with a detailed message, starting with what you are working with (i.e. "vision: Update Kernel")
-Commit your patches in a single commit. Squash multiple commits using this command: `git rebase -i HEAD~<# of commits>`
-
-To view the status of your and others' patches, visit [LineageOS Code Review](https://review.lineageos.org/)
+WTF is this?
+------------
 
+This is an unofficial LineageOS organization with the necessary patches for full [Substratum](https://github.com/substratum/substratum) support. To learn more about Substratum, check out their [documentation repo](https://github.com/substratum/documentation).
 
 Getting Started
 ---------------
@@ -31,22 +12,15 @@ Getting Started
 To get started with Android/LineageOS, you'll need to get
 familiar with [Git and Repo](https://source.android.com/source/using-repo.html).
 
-To initialize your local repository using the LineageOS trees, use a command like this:
+To initialize your local repository using the LineageOMS trees, use a command like this:
 
-    repo init -u git://github.com/LineageOS/android.git -b cm-14.1
+    repo init -u https://github.com/LineageOMS/android.git -b cm-14.1 --no-clone-bundle --depth=1
 
 Then to sync up:
 
-    repo sync
-
-Please see the [LineageOS Wiki](https://wiki.lineageos.org/) for building instructions.
-
-
-Buildbot
---------
+    repo sync -j$( nproc --all ) --force-sync -c --no-clone-bundle --no-tags --optimized-fetch --prune
 
-All supported devices are built weekly and periodically as changes are committed to ensure the source trees remain buildable.
 
-You can view the current build statuses at [LineageOS Jenkins](https://jenkins.lineageos.org/)
+The extra flags on the `repo init` command will make the repo much smaller by initializing shallow clones. To pull down new changes, run the repo sync command.
 
-Builds produced weekly by the buildbot can be downloaded from [LineageOS downloads](https://download.lineageos.org/)
+Please see the [LineageOS Wiki](http://wiki.lineageos.org/) for further building instructions.
diff --git a/default.xml b/default.xml
index 73a35b0d..a96e7232 100644
--- a/default.xml
+++ b/default.xml
@@ -511,4 +511,7 @@
 
   <include name="snippets/cm.xml" />
 
+  <!-- Substratum support -->
+  <include name="snippets/substratum.xml" />
+
 </manifest>
diff --git a/snippets/substratum.xml b/snippets/substratum.xml
new file mode 100644
index 00000000..2343314d
--- /dev/null
+++ b/snippets/substratum.xml
@@ -0,0 +1,31 @@
+<?xml version="1.0" encoding="UTF-8"?>
+<manifest>
+    <!-- Get rid of Lineage repos -->
+    <remove-project name="LineageOS/android_frameworks_base" />
+    <remove-project name="LineageOS/android_frameworks_native" />
+    <remove-project name="LineageOS/android_packages_apps_Contacts" />
+    <remove-project name="LineageOS/android_packages_apps_ContactsCommon" />
+    <remove-project name="LineageOS/android_packages_apps_Dialer" />
+    <remove-project name="LineageOS/android_packages_apps_ExactCalculator" />
+    <remove-project name="LineageOS/android_packages_apps_PackageInstaller" />
+    <remove-project name="LineageOS/android_packages_apps_PhoneCommon" />
+    <remove-project name="LineageOS/android_packages_apps_Settings" />
+    <remove-project name="LineageOS/android_system_sepolicy" />
+    <remove-project name="LineageOS/android_vendor_cm" />
+
+    <!-- Track our repos -->
+    <project path="frameworks/base" name="LineageOMS/android_frameworks_base" />
+    <project path="frameworks/native" name="LineageOMS/android_frameworks_native" />
+    <project path="packages/apps/Contacts" name="LineageOMS/android_packages_apps_Contacts" />
+    <project path="packages/apps/ContactsCommon" name="LineageOMS/android_packages_apps_ContactsCommon" />
+    <project path="packages/apps/Dialer" name="LineageOMS/android_packages_apps_Dialer" />
+    <project path="packages/apps/ExactCalculator" name="LineageOMS/android_packages_apps_ExactCalculator" />
+    <project path="packages/apps/PackageInstaller" name="LineageOMS/android_packages_apps_PackageInstaller" />
+    <project path="packages/apps/PhoneCommon" name="LineageOMS/android_packages_apps_PhoneCommon" />
+    <project path="packages/apps/Settings" name="LineageOMS/android_packages_apps_Settings" />
+    <project path="system/sepolicy" name="LineageOMS/android_system_sepolicy" />
+    <project path="vendor/cm" name="LineageOMS/android_vendor_cm" />
+
+    <!-- Track ThemeInterfacer -->
+    <project path="packages/services/ThemeInterfacer" name="substratum/interfacer" remote="github" revision="n-rootless" />
+</manifest>

